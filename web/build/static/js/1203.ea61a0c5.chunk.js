"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[1203],{16018:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(93766),n=a(21215),r=a.n(n);class c{constructor(e){this.group="",this.getById=async e=>{let t=await s.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=r().stringify(e),a=await s.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==a.code?{}:a.data},this.getAll=async()=>{let e=await s.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await s.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await s.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await s.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},80398:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(16018),n=a(93766);class r extends s.A{constructor(){var e;super("assets"),e=this,this.GetAll=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=await n.A.get("/".concat(e.group,"?protocol=").concat(t));return 1!==a.code?[]:a.data},this.connTest=async e=>{let t=await n.A.post("/".concat(this.group,"/").concat(e,"/tcping"));return 1!==t.code?[!1,t.message]:[t.data.active,t.data.message]},this.importAsset=async e=>{const t=new FormData;t.append("file",e);let a=await n.A.post("/".concat(this.group,"/import"),t,{"Content-Type":"multipart/form-data"});return 1!==a.code?[!1,a.message]:[!0,a.data]},this.changeOwner=async(e,t)=>1===(await n.A.post("/".concat(this.group,"/").concat(e,"/change-owner?owner=").concat(t))).code}}const c=new r},52142:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(21215),n=a.n(s),r=a(93766);const c=new class{constructor(){this.group="authorised",this.GetAssetPaging=async e=>{let t=n().stringify(e),a=await r.A.get("/".concat(this.group,"/assets/paging?").concat(t));return 1!==a.code?{}:a.data},this.GetUserPaging=async e=>{let t=n().stringify(e),a=await r.A.get("/".concat(this.group,"/users/paging?").concat(t));return 1!==a.code?{}:a.data},this.GetUserGroupPaging=async e=>{let t=n().stringify(e),a=await r.A.get("/".concat(this.group,"/user-groups/paging?").concat(t));return 1!==a.code?{}:a.data},this.AuthorisedAssets=async e=>1===(await r.A.post("/".concat(this.group,"/assets"),e)).code,this.AuthorisedUsers=async e=>1===(await r.A.post("/".concat(this.group,"/users"),e)).code,this.AuthorisedUserGroups=async e=>1===(await r.A.post("/".concat(this.group,"/user-groups"),e)).code,this.GetSelected=async e=>{let t=n().stringify(e),a=await r.A.get("/".concat(this.group,"/selected?").concat(t));return 1!==a.code?[]:a.data},this.DeleteById=async e=>1===(await r.A.delete("/".concat(this.group,"/").concat(e))).code}}},54081:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(16018),n=a(93766);class r extends s.A{constructor(){super("strategies"),this.GetAll=async()=>{let e=await n.A.get("/".concat(this.group));return 1!==e.code?[]:e.data}}}const c=new r},8425:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(16018),n=a(93766);class r extends s.A{constructor(){super("user-groups"),this.GetAll=async()=>{let e=await n.A.get("/".concat(this.group));return 1!==e.code?[]:e.data}}}const c=new r},16623:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(16018),n=a(93766);class r extends s.A{constructor(){super("users"),this.resetTotp=async e=>1===(await n.A.post("/".concat(this.group,"/").concat(e,"/reset-totp"))).code,this.changePassword=async(e,t)=>{let a=new FormData;return a.set("password",t),1===(await n.A.post("/".concat(this.group,"/").concat(e,"/change-password"),a)).code},this.changeStatus=async(e,t)=>1!==(await n.A.patch("/".concat(this.group,"/").concat(e,"/status?status=").concat(t))).code}}const c=new r},91203:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var s=a(9950),n=a(28429),r=a(42074),c=a(72381),i=a(91524),o=a(12916),l=a(8425),d=a(44414);const u=l.A,h=e=>{var t;let{active:a,id:n}=e,[r,c]=(0,s.useState)({});return(0,s.useEffect)((()=>{a&&n&&(async e=>{let t=await u.getById(e);t&&c(t)})(n)}),[a]),(0,d.jsx)("div",{className:"page-detail-info",children:(0,d.jsxs)(i.A,{column:1,children:[(0,d.jsx)(i.A.Item,{label:"\u540d\u79f0",children:r.name}),(0,d.jsx)(i.A.Item,{label:"\u6210\u5458",children:null===(t=r.members)||void 0===t?void 0:t.map((e=>(0,d.jsx)(o.A,{children:e.name})))}),(0,d.jsx)(i.A.Item,{label:"\u521b\u5efa\u65f6\u95f4",children:r.created})]})})};var g=a(83225),p=a(50070);a(6087);const A=()=>{const e=(0,n.g)().userGroupId,[t,a]=(0,r.ok)();let i=t.get("activeKey");i=i||"info";let[o,l]=(0,s.useState)(i);return(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"page-detail-warp",children:(0,d.jsxs)(c.A,{activeKey:o,onChange:e=>{l(e),a({activeKey:e})},children:[(0,p.as)("user-group-detail")&&(0,d.jsx)(c.A.TabPane,{tab:"\u57fa\u672c\u4fe1\u606f",children:(0,d.jsx)(h,{active:"info"===o,id:e})},"info"),(0,p.as)("user-group-detail")&&(0,d.jsx)(c.A.TabPane,{tab:"\u6388\u6743\u7684\u8d44\u4ea7",children:(0,d.jsx)(g.A,{active:"asset"===o,id:e,type:"userGroupId"})},"asset")]})})})}},83225:(e,t,a)=>{a.d(t,{A:()=>w});var s=a(9950),n=a(48538),r=a(27666),c=a(52142),i=a(87827),o=a(87427),l=a(99674),d=a(80398),u=a(54081),h=a(44414);const g={labelCol:{span:6},wrapperCol:{span:14}},p=e=>{let{type:t,id:a,visible:n,handleOk:r,handleCancel:p,confirmLoading:A}=e;const[y]=i.A.useForm();let[m,w]=(0,s.useState)([]),[x,v]=(0,s.useState)([]),[f,j]=(0,s.useState)([]);(0,s.useEffect)((()=>{n?async function(){let e={key:"assetId"};"userId"===t?e.userId=a:e.userGroupId=a;let s=await c.A.GetSelected(e);w(s);let n=await d.A.GetAll();v(n);let r=await u.A.GetAll();j(r)}():y.resetFields()}),[n]);let b=f.map((e=>({value:e.id,label:e.name}))),I=x.map((e=>({value:e.id,label:e.name,disabled:m.includes(e.id)})));return(0,h.jsx)(o.A,{title:"\u8d44\u4ea7\u6388\u6743",visible:n,maskClosable:!1,destroyOnClose:!0,onOk:()=>{y.validateFields().then((async e=>{await r(e)&&y.resetFields()}))},onCancel:()=>{y.resetFields(),p()},confirmLoading:A,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,h.jsxs)(i.A,{form:y,...g,children:[(0,h.jsx)(i.A.Item,{label:"\u8d44\u4ea7",name:"assetIds",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d44\u4ea7"}],children:(0,h.jsx)(l.A,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u8d44\u4ea7",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:I})}),(0,h.jsx)(i.A.Item,{label:"\u6388\u6743\u7b56\u7565",name:"strategyId",extra:"\u53ef\u63a7\u5236\u6388\u6743\u7528\u6237\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\u7b49\u529f\u80fd",children:(0,h.jsx)(l.A,{allowClear:!0,style:{width:"100%"},placeholder:"\u6b64\u5b57\u6bb5\u4e0d\u662f\u5fc5\u586b\u7684",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:b})})]})})};var A=a(42074),y=a(68201);const m=s.createRef(),w=e=>{let{active:t,id:a,type:i}=e,[o,l]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{t&&m.current.reload()}),[t]);const g=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u8d44\u4ea7\u540d\u79f0",dataIndex:"assetName",render:(e,t)=>(0,h.jsx)(A.N_,{to:"/asset/".concat(t.assetId),children:e})},{title:"\u6388\u6743\u7b56\u7565\u540d\u79f0",dataIndex:"strategyName",hideInSearch:!0,render:(e,t)=>(0,h.jsx)(A.N_,{to:"/strategy/".concat(t.strategyId),children:e})},{title:"\u6388\u6743\u65e5\u671f",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",width:50,render:(e,t,a,s)=>[(0,h.jsx)(y.A,{menu:["user-unbind-asset","user-group-unbind-asset"],children:(0,h.jsx)("a",{onClick:async()=>{await c.A.DeleteById(t.id),m.current.reload()},children:"\u79fb\u9664"},"unbind")})]}];return(0,h.jsxs)("div",{children:[(0,h.jsx)(r.A,{columns:g,actionRef:m,request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s="",n="";Object.keys(t).length>0&&(s=Object.keys(t)[0],n=Object.values(t)[0]);let r={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:s,order:n};r[i]=a;let o=await c.A.GetAssetPaging(r);return{data:o.items,success:!0,total:o.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u6388\u6743\u7684\u8d44\u4ea7\u5217\u8868",toolBarRender:()=>[(0,h.jsx)(y.A,{menu:["user-bind-asset","user-group-bind-asset"],children:(0,h.jsx)(n.A,{type:"primary",onClick:()=>{l(!0)},children:"\u6388\u6743"},"button")})]}),(0,h.jsx)(p,{type:i,id:a,visible:o,confirmLoading:d,handleCancel:()=>{l(!1)},handleOk:async e=>{u(!0),e[i]=a;try{c.A.AuthorisedAssets(e)&&l(!1),m.current.reload()}finally{u(!1)}}})]})}},6087:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(80575),n=a(91524),r=a(16623),c=a(41920),i=a(98409),o=a(44414);const l=e=>{let{active:t,userId:a}=e,l=(0,c.useQuery)("getUserById",(()=>r.A.getById(a)),{enabled:t&&i.A.hasText(a)}),d=l.data||{};return l.isLoading?(0,o.jsx)("div",{className:"page-detail-info",children:(0,o.jsx)(s.A,{})}):(0,o.jsx)("div",{className:"page-detail-info",children:(0,o.jsxs)(n.A,{title:"\u57fa\u672c\u4fe1\u606f",column:1,children:[(0,o.jsx)(n.A.Item,{label:"\u7528\u6237\u540d",children:d.username}),(0,o.jsx)(n.A.Item,{label:"\u6635\u79f0",children:d.nickname}),(0,o.jsx)(n.A.Item,{label:"\u90ae\u7bb1",children:d.mail}),(0,o.jsx)(n.A.Item,{label:"\u72b6\u6001",children:"enabled"===d.status?"\u5f00\u542f":"\u5173\u95ed"}),(0,o.jsx)(n.A.Item,{label:"\u53cc\u56e0\u7d20\u8ba4\u8bc1",children:d.totpSecret}),(0,o.jsx)(n.A.Item,{label:"\u6765\u6e90",children:"ldap"===d.source?"LDAP":"\u6570\u636e\u5e93"}),(0,o.jsx)(n.A.Item,{label:"\u521b\u5efa\u65f6\u95f4",children:d.created})]})})}},68201:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(50070);const n=e=>{let{menu:t,children:a}=e;if(Array.isArray(t)){if((0,s.as)(...t))return a}else if((0,s.as)(t))return a}},98409:(e,t,a)=>{a.d(t,{A:()=>s});const s=new class{constructor(){this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){let a=e.toString();for(;a.length<t;)a="0"+a;return a}}}}}]);