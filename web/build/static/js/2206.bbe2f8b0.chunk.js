"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[2206,6149],{3464:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var a=s(9950),r=s(68832),l=s(50559),n=s(92759),i=s(72381),c=s(87827),d=s(55902),o=s(48538),h=s(96457),u=s(80737),A=s(53765),x=s(32312),p=s(87427),j=s(37866),m=s(27379),y=s(41920),w=s(44414);const{Title:g}=l.A,b=()=>{var e;let t=(0,y.useQuery)("infoQuery",h.A.getUserInfo),[s,r]=(0,a.useState)({});const l=async()=>{let e=await h.A.reloadTotp();r(e)},i=async e=>{e.secret=s.secret,await h.A.confirmTotp(e)&&(n.Ay.success("TOTP\u542f\u7528\u6210\u529f"),await t.refetch(),r({}))};return(0,w.jsxs)("div",{children:[(0,w.jsx)(g,{level:4,children:"\u53cc\u56e0\u7d20\u8ba4\u8bc1"}),(0,w.jsx)(c.A,{hidden:s.qr,children:(0,w.jsx)(c.A.Item,{children:null!==(e=t.data)&&void 0!==e&&e.enableTotp?(0,w.jsx)(x.Ay,{status:"success",title:"\u60a8\u5df2\u6210\u529f\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1!",subTitle:"\u591a\u56e0\u7d20\u8ba4\u8bc1-MFA\u4e8c\u6b21\u8ba4\u8bc1-\u767b\u5f55\u8eab\u4efd\u9274\u522b,\u8bbf\u95ee\u63a7\u5236\u66f4\u5b89\u5168\u3002",extra:[(0,w.jsx)(o.A,{type:"primary",danger:!0,onClick:()=>{p.A.confirm({title:"\u60a8\u786e\u8ba4\u8981\u89e3\u9664\u53cc\u56e0\u7d20\u8ba4\u8bc1\u5417\uff1f",icon:(0,w.jsx)(m.A,{}),content:"\u89e3\u9664\u4e4b\u540e\u53ef\u80fd\u5b58\u5728\u7cfb\u7edf\u8d26\u53f7\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:async()=>{await h.A.resetTotp()&&(n.Ay.success("\u53cc\u56e0\u7d20\u8ba4\u8bc1\u89e3\u9664\u6210\u529f"),await t.refetch())},onCancel(){console.log("Cancel")}})},children:"\u89e3\u9664\u7ed1\u5b9a"},"console"),(0,w.jsx)(o.A,{onClick:l,children:"\u91cd\u65b0\u7ed1\u5b9a"},"re-bind")]}):(0,w.jsx)(x.Ay,{status:"warning",title:"\u60a8\u8fd8\u672a\u5f00\u542f\u53cc\u56e0\u7d20\u8ba4\u8bc1\uff01",subTitle:"\u7cfb\u7edf\u8d26\u53f7\u5b58\u5728\u88ab\u66b4\u529b\u7834\u89e3\u7684\u98ce\u9669\u3002",extra:(0,w.jsx)(o.A,{type:"primary",onClick:l,children:"\u53bb\u5f00\u542f"},"bind")})})}),(e=>{if(e)return(0,w.jsxs)(c.A,{hidden:!s.qr,onFinish:i,children:[(0,w.jsx)(c.A.Item,{label:"\u4e8c\u7ef4\u7801",extra:"\u6709\u6548\u671f30\u79d2\uff0c\u5728\u626b\u63cf\u540e\u8bf7\u5c3d\u5feb\u8f93\u5165\u3002\u63a8\u8350\u4f7f\u7528Google Authenticator, Authy \u6216\u8005 Microsoft Authenticator\u3002",children:(0,w.jsxs)(u.A,{size:12,direction:"horizontal",children:[(0,w.jsx)(A.A,{style:{padding:20},width:280,src:"data:image/png;base64, "+s.qr}),(0,w.jsx)(o.A,{type:"primary",icon:(0,w.jsx)(j.A,{}),onClick:l,children:"\u91cd\u65b0\u52a0\u8f7d"})]})}),(0,w.jsx)(c.A.Item,{name:"totp",label:"TOTP",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"}],children:(0,w.jsx)(d.A,{placeholder:"\u8bf7\u8f93\u5165\u53cc\u56e0\u7d20\u8ba4\u8bc1APP\u4e2d\u663e\u793a\u7684\u6388\u6743\u7801"})}),(0,w.jsx)(c.A.Item,{children:(0,w.jsx)(o.A,{type:"primary",htmlType:"submit",children:"\u786e\u8ba4"})})]})})(s.qr)]})},{Content:f}=r.A,{Title:v}=l.A,T=()=>{let[e,t]=(0,a.useState)(""),[s,r]=(0,a.useState)(""),[l,u]=(0,a.useState)({});const A=(e,t)=>t===e?{validateStatus:"success",errorMsg:null}:{validateStatus:"error",errorMsg:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"};return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(f,{className:"page-container-white",children:(0,w.jsxs)(i.A,{className:"info-tab",tabPosition:"left",tabBarStyle:{width:150},children:[(0,w.jsxs)(i.A.TabPane,{tab:"\u4fee\u6539\u5bc6\u7801",children:[(0,w.jsx)(v,{level:4,children:"\u4fee\u6539\u5bc6\u7801"}),(0,w.jsx)("div",{style:{margin:16}}),(0,w.jsxs)(c.A,{name:"password",onFinish:async e=>{await h.A.changePassword(e)&&(n.Ay.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875\u9762"),window.location.href="/#")},children:[(0,w.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),(0,w.jsx)(c.A.Item,{name:"oldPassword",label:"\u539f\u59cb\u5bc6\u7801",rules:[{required:!0,message:"\u539f\u59cb\u5bc6\u7801"}],children:(0,w.jsx)(d.A,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u539f\u59cb\u5bc6\u7801",style:{width:240}})}),(0,w.jsx)(c.A.Item,{name:"newPassword",label:"\u65b0\u7684\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u7684\u5bc6\u7801"}],children:(0,w.jsx)(d.A,{type:"password",placeholder:"\u65b0\u7684\u5bc6\u7801",onChange:e=>(e=>{t(e.target.value),u(A(e.target.value,s))})(e),style:{width:240}})}),(0,w.jsx)(c.A.Item,{name:"newPassword2",label:"\u786e\u8ba4\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4"}],validateStatus:l.validateStatus,help:l.errorMsg||" ",children:(0,w.jsx)(d.A,{type:"password",placeholder:"\u8bf7\u548c\u4e0a\u9762\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4",onChange:t=>(t=>{r(t.target.value),u(A(e,t.target.value))})(t),style:{width:240}})}),(0,w.jsx)(c.A.Item,{children:(0,w.jsx)(o.A,{disabled:l.errorMsg||!l.validateStatus,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]},"change-password"),(0,w.jsx)(i.A.TabPane,{tab:"\u4e24\u6b65\u8ba4\u8bc1",children:(0,w.jsx)(b,{})},"totp")]})})})}},79527:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});s(9950);var a=s(3464),r=s(44414);const l=()=>(0,r.jsx)("div",{style:{backgroundColor:"white"},children:(0,r.jsx)(a.default,{})})},37866:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(89379),r=s(9950);const l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};var n=s(38913),i=function(e,t){return r.createElement(n.A,(0,a.A)((0,a.A)({},e),{},{ref:t,icon:l}))};i.displayName="ReloadOutlined";const c=r.forwardRef(i)},90820:(e,t,s)=>{s.d(t,{A:()=>a});const a=s(19307).A}}]);