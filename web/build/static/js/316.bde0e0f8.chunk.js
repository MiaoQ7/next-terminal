"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[316],{16018:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(93766),c=n(21215),r=n.n(c);class o{constructor(e){this.group="",this.getById=async e=>{let t=await a.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=r().stringify(e),n=await a.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==n.code?{}:n.data},this.getAll=async()=>{let e=await a.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await a.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await a.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await a.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},75098:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(93766),c=n(21215),r=n.n(c),o=n(16018);class i extends o.A{constructor(){super("login-policies"),this.Bind=async(e,t)=>1===(await a.A.post("/".concat(this.group,"/").concat(e,"/bind"),t)).code,this.Unbind=async(e,t)=>1===(await a.A.post("/".concat(this.group,"/").concat(e,"/unbind"),t)).code,this.GetUserPagingByForbiddenCommandId=async(e,t)=>{let n=r().stringify(t),c=await a.A.get("/".concat(this.group,"/").concat(e,"/users/paging?").concat(n));return 1!==c.code?{}:c.data},this.GetUserIdByLoginPolicyId=async e=>{let t=await a.A.get("/".concat(this.group,"/").concat(e,"/users/id"));return 1!==t.code?[]:t.data}}}const l=new i},16623:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(16018),c=n(93766);class r extends a.A{constructor(){super("users"),this.resetTotp=async e=>1===(await c.A.post("/".concat(this.group,"/").concat(e,"/reset-totp"))).code,this.changePassword=async(e,t)=>{let n=new FormData;return n.set("password",t),1===(await c.A.post("/".concat(this.group,"/").concat(e,"/change-password"),n)).code},this.changeStatus=async(e,t)=>1!==(await c.A.patch("/".concat(this.group,"/").concat(e,"/status?status=").concat(t))).code}}const o=new r},30316:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(9950),c=n(72381),r=n(28429),o=n(42074),i=n(91524),l=n(69627),s=n(27646),d=n(75098),u=n(44414);const m=e=>{var t;let{active:n,id:c}=e,[r,o]=(0,a.useState)({});return(0,a.useEffect)((()=>{n&&c&&(async e=>{let t=await d.A.getById(e);t&&o(t)})(c)}),[n]),(0,u.jsx)("div",{className:"page-detail-info",children:(0,u.jsxs)(i.A,{column:1,children:[(0,u.jsx)(i.A.Item,{label:"\u540d\u79f0",children:r.name}),(0,u.jsx)(i.A.Item,{label:"\u4f18\u5148\u7ea7",children:r.priority}),(0,u.jsx)(i.A.Item,{label:"IP\u5730\u5740",children:r.ipGroup}),(0,u.jsx)(i.A.Item,{label:"\u65f6\u6bb5",children:null===(t=r.timePeriod)||void 0===t?void 0:t.map((e=>{if((0,s.I3)(e.value))return(0,u.jsxs)(u.Fragment,{children:["".concat((0,l.N)(e.key)," \uff1a").concat(e.value),(0,u.jsx)("br",{})]})}))}),(0,u.jsx)(i.A.Item,{label:"\u89c4\u5219",children:"allow"===r.rule?"\u5141\u8bb8":"\u62d2\u7edd"}),(0,u.jsx)(i.A.Item,{label:"\u6fc0\u6d3b",children:r.enabled?"\u2705":"\u274c"})]})})};var p=n(48538),y=n(99019),h=n(27666),g=n(16623);const b=a.createRef(),v=e=>{let{visible:t,loginPolicyId:n}=e,[c,r]=(0,a.useState)([]);(0,a.useEffect)((()=>{(async()=>{let e=await d.A.GetUserIdByLoginPolicyId(n);r(e)})()}),[t]);const o=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u767b\u5f55\u8d26\u53f7",dataIndex:"username",copyable:!0},{title:"\u6635\u79f0",dataIndex:"nickname",copyable:!0},{title:"\u90ae\u7bb1",key:"mail",dataIndex:"mail"},{title:"\u521b\u5efa\u65f6\u95f4",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:(e,t,a,o)=>[(0,u.jsx)("a",{onClick:()=>{(async e=>{await d.A.Bind(n,[{userId:e}]),c.push(e),r(c),b.current.reload()})(t.id)},disabled:c.includes(t.id),children:"\u7ed1\u5b9a"},"unbind")]}];return(0,u.jsx)("div",{children:(0,u.jsx)(h.A,{columns:o,actionRef:b,request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n="",a="";Object.keys(t).length>0&&(n=Object.keys(t)[0],a=Object.values(t)[0]);let c={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:n,order:a},r=await g.A.getPaging(c);return{data:r.items,success:!0,total:r.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u7528\u6237\u5217\u8868"})})};var x=n(68201);const A=a.createRef(),f=e=>{let{active:t,loginPolicyId:n}=e,[c,r]=(0,a.useState)(!1);const o=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u767b\u5f55\u8d26\u53f7",dataIndex:"username",copyable:!0},{title:"\u6635\u79f0",dataIndex:"nickname",copyable:!0},{title:"\u90ae\u7bb1",key:"mail",dataIndex:"mail"},{title:"\u521b\u5efa\u65f6\u95f4",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:(e,t,a,c)=>[(0,u.jsx)(x.A,{menu:"login-policy-unbind-user",children:(0,u.jsx)("a",{onClick:()=>{(async e=>{await d.A.Unbind(n,[{userId:e}]),A.current.reload()})(t.id)},children:"\u89e3\u7ed1"},"unbind")})]}];return(0,u.jsxs)("div",{children:[(0,u.jsx)(h.A,{columns:o,actionRef:A,request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a="",c="";Object.keys(t).length>0&&(a=Object.keys(t)[0],c=Object.values(t)[0]);let r={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:a,order:c},o=await d.A.GetUserPagingByForbiddenCommandId(n,r);return{data:o.items,success:!0,total:o.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u7ed1\u5b9a\u7528\u6237\u5217\u8868",toolBarRender:()=>[(0,u.jsx)(x.A,{menu:"login-policy-bind-user",children:(0,u.jsx)(p.A,{type:"primary",onClick:()=>{r(!0)},children:"\u7ed1\u5b9a"},"button")})]}),(0,u.jsx)(y.A,{title:"\u7ed1\u5b9a\u7528\u6237",placement:"right",width:.7*window.innerWidth,onClose:()=>{r(!1),A.current.reload()},visible:c,children:(0,u.jsx)(v,{visible:c,loginPolicyId:n})})]})},{TabPane:w}=c.A,I=()=>{const e=(0,r.g)().loginPolicyId,[t,n]=(0,o.ok)();let i=t.get("activeKey");i=i||"info";let[l,s]=(0,a.useState)(i);return(0,u.jsx)("div",{className:"page-detail-warp",children:(0,u.jsxs)(c.A,{activeKey:l,onChange:e=>{s(e),n({activeKey:e})},children:[(0,u.jsx)(w,{tab:"\u57fa\u672c\u4fe1\u606f",children:(0,u.jsx)(m,{active:"info"===l,id:e})},"info"),(0,u.jsx)(w,{tab:"\u7ed1\u5b9a\u7528\u6237",children:(0,u.jsx)(f,{active:"bind-user"===l,loginPolicyId:e})},"bind-user"),(0,u.jsx)(w,{tab:"\u7ed1\u5b9a\u7528\u6237\u7ec4",children:"\u6682\u672a\u5b9e\u73b0"},"bind-user-group")]})})}},68201:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(50070);const c=e=>{let{menu:t,children:n}=e;if(Array.isArray(t)){if((0,a.as)(...t))return n}else if((0,a.as)(t))return n}},69627:(e,t,n)=>{n.d(t,{N:()=>c});const a={1:"\u4e00",2:"\u4e8c",3:"\u4e09",4:"\u56db",5:"\u4e94",6:"\u516d",0:"\u65e5"},c=e=>"\u661f\u671f"+a[e]},91524:(e,t,n)=>{n.d(t,{h:()=>x,A:()=>I});var a=n(64467),c=n(5544),r=n(82284),o=n(48738),i=n.n(o),l=n(18909),s=n(9950),d=n(5741),u=n(39156),m=n(86557);const p=function(e){return e.children};var y=n(58168);function h(e){return void 0!==e&&null!==e}const g=function(e){var t,n=e.itemPrefixCls,c=e.component,r=e.span,o=e.className,l=e.style,d=e.labelStyle,u=e.contentStyle,m=e.bordered,p=e.label,y=e.content,g=e.colon,b=c;return m?s.createElement(b,{className:i()((t={},(0,a.A)(t,"".concat(n,"-item-label"),h(p)),(0,a.A)(t,"".concat(n,"-item-content"),h(y)),t),o),style:l,colSpan:r},h(p)&&s.createElement("span",{style:d},p),h(y)&&s.createElement("span",{style:u},y)):s.createElement(b,{className:i()("".concat(n,"-item"),o),style:l,colSpan:r},s.createElement("div",{className:"".concat(n,"-item-container")},(p||0===p)&&s.createElement("span",{className:i()("".concat(n,"-item-label"),(0,a.A)({},"".concat(n,"-item-no-colon"),!g)),style:d},p),(y||0===y)&&s.createElement("span",{className:i()("".concat(n,"-item-content")),style:u},y)))};function b(e,t,n){var a=t.colon,c=t.prefixCls,r=t.bordered,o=n.component,i=n.type,l=n.showLabel,d=n.showContent,u=n.labelStyle,m=n.contentStyle;return e.map((function(e,t){var n=e.props,p=n.label,h=n.children,b=n.prefixCls,v=void 0===b?c:b,x=n.className,A=n.style,f=n.labelStyle,w=n.contentStyle,I=n.span,j=void 0===I?1:I,k=e.key;return"string"===typeof o?s.createElement(g,{key:"".concat(i,"-").concat(k||t),className:x,style:A,labelStyle:(0,y.A)((0,y.A)({},u),f),contentStyle:(0,y.A)((0,y.A)({},m),w),span:j,colon:a,component:o,itemPrefixCls:v,bordered:r,label:l?p:null,content:d?h:null}):[s.createElement(g,{key:"label-".concat(k||t),className:x,style:(0,y.A)((0,y.A)((0,y.A)({},u),A),f),span:1,colon:a,component:o[0],itemPrefixCls:v,bordered:r,label:p}),s.createElement(g,{key:"content-".concat(k||t),className:x,style:(0,y.A)((0,y.A)((0,y.A)({},m),A),w),span:2*j-1,component:o[1],itemPrefixCls:v,bordered:r,content:h})]}))}const v=function(e){var t=s.useContext(x),n=e.prefixCls,a=e.vertical,c=e.row,r=e.index,o=e.bordered;return a?s.createElement(s.Fragment,null,s.createElement("tr",{key:"label-".concat(r),className:"".concat(n,"-row")},b(c,e,(0,y.A)({component:"th",type:"label",showLabel:!0},t))),s.createElement("tr",{key:"content-".concat(r),className:"".concat(n,"-row")},b(c,e,(0,y.A)({component:"td",type:"content",showContent:!0},t)))):s.createElement("tr",{key:r,className:"".concat(n,"-row")},b(c,e,(0,y.A)({component:o?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))};var x=s.createContext({}),A={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function f(e,t,n){var a=e;return(void 0===t||t>n)&&(a=(0,u.Ob)(e,{span:n})),a}function w(e){var t,n=e.prefixCls,o=e.title,u=e.extra,p=e.column,y=void 0===p?A:p,h=e.colon,g=void 0===h||h,b=e.bordered,w=e.layout,I=e.children,j=e.className,k=e.style,S=e.size,E=e.labelStyle,C=e.contentStyle,N=s.useContext(d.QO),P=N.getPrefixCls,B=N.direction,O=P("descriptions",n),T=s.useState({}),z=(0,c.A)(T,2),F=z[0],U=z[1],G=function(e,t){if("number"===typeof e)return e;if("object"===(0,r.A)(e))for(var n=0;n<m.ye.length;n++){var a=m.ye[n];if(t[a]&&void 0!==e[a])return e[a]||A[a]}return 3}(y,F);s.useEffect((function(){var e=m.Ay.subscribe((function(e){"object"===(0,r.A)(y)&&U(e)}));return function(){m.Ay.unsubscribe(e)}}),[]);var K=function(e,t){var n=(0,l.A)(e).filter((function(e){return e})),a=[],c=[],r=t;return n.forEach((function(e,o){var i,l=null===(i=e.props)||void 0===i?void 0:i.span,s=l||1;if(o===n.length-1)return c.push(f(e,l,r)),void a.push(c);s<r?(r-=s,c.push(e)):(c.push(f(e,s,r)),a.push(c),r=t,c=[])})),a}(I,G),L=s.useMemo((function(){return{labelStyle:E,contentStyle:C}}),[E,C]);return s.createElement(x.Provider,{value:L},s.createElement("div",{className:i()(O,(t={},(0,a.A)(t,"".concat(O,"-").concat(S),S&&"default"!==S),(0,a.A)(t,"".concat(O,"-bordered"),!!b),(0,a.A)(t,"".concat(O,"-rtl"),"rtl"===B),t),j),style:k},(o||u)&&s.createElement("div",{className:"".concat(O,"-header")},o&&s.createElement("div",{className:"".concat(O,"-title")},o),u&&s.createElement("div",{className:"".concat(O,"-extra")},u)),s.createElement("div",{className:"".concat(O,"-view")},s.createElement("table",null,s.createElement("tbody",null,K.map((function(e,t){return s.createElement(v,{key:t,index:t,colon:g,prefixCls:O,vertical:"vertical"===w,bordered:b,row:e})})))))))}w.Item=p;const I=w}}]);