"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[3920],{20844:(e,l,t)=>{t.r(l),t.d(l,{default:()=>k});var i=t(9950),n=t(99674),r=t(72381),s=t(50559),a=t(92759),c=t(87827),h=t(43637),d=t(48538),o=t(55902),m=t(99985),u=t(80737),p=t(93766),x=t(27646),j=t(39608);t(4159);var g=t(44414);const{Option:A}=n.A,{TabPane:y}=r.A,{Title:b}=s.A,v={labelCol:{span:12},wrapperCol:{span:12}},f={labelCol:{span:12},wrapperCol:{span:12}};class C extends i.Component{constructor(){super(...arguments),this.state={refs:[],properties:{},ldapUserSyncLoading:!1,license:{name:"\u514d\u8d39\u7248",expired:void 0},machineId:""},this.rdpSettingFormRef=i.createRef(),this.sshSettingFormRef=i.createRef(),this.vncSettingFormRef=i.createRef(),this.guacdSettingFormRef=i.createRef(),this.mailSettingFormRef=i.createRef(),this.logSettingFormRef=i.createRef(),this.otherSettingFormRef=i.createRef(),this.changeProperties=async e=>{let l=await p.A.put("/properties",e);1===l.code?a.Ay.success("\u4fee\u6539\u6210\u529f"):a.Ay.error(l.message)},this.getProperties=async()=>{let e=await p.A.get("/properties");if(1===e.code){let l=e.data;for(let e in l)l.hasOwnProperty(e)&&("-"===l[e]&&(l[e]=""),(e.startsWith("enable")||e.startsWith("disable"))&&(l[e]=l[e].bool()));this.setState({properties:l});for(let e of this.state.refs)e.current&&e.current.setFieldsValue(l)}else a.Ay.error(e.message)},this.handleOnTabChange=e=>{"license"===e?(this.getMachineId(),this.getLicense()):this.getProperties()},this.getLicense=async()=>{let e=await(async()=>{let e=await p.A.get("/license");if(1===e.code)return e.data})();e&&this.setState({license:e})},this.getMachineId=async()=>{let e=await(async()=>{let e=await p.A.get("/license/machine-id");if(1===e.code)return e.data})();this.setState({machineId:e})},this.handleImport=()=>{let e=window.document.getElementById("file-upload").files;if(0===e.length)return;const l=new FileReader;l.onload=async()=>{let e=JSON.parse(l.result.toString());this.setState({importBtnLoading:!0});try{let l=await p.A.post("/backup/import",e);1===l.code?a.Ay.success("\u6062\u590d\u6210\u529f",3):a.Ay.error(l.message,10)}finally{this.setState({importBtnLoading:!1}),window.document.getElementById("file-upload").value=""}},l.readAsText(e[0])},this.ldapUserSync=async()=>{const e="ldap-user-sync";try{this.setState({ldapUserSyncLoading:!0}),a.Ay.info({content:"\u540c\u6b65\u4e2d...",key:e,duration:5});let l=await p.A.post("/properties/ldap-user-sync");if(1!==l.code)return void a.Ay.error({content:l.message,key:e,duration:10});a.Ay.success({content:"\u540c\u6b65\u6210\u529f\u3002",key:e,duration:3})}finally{this.setState({ldapUserSyncLoading:!1})}},this.handleImportLicense=()=>{let e=window.document.getElementById("import-license").files;if(0===e.length)return;let l=e[0];const t=new FileReader;t.onload=async()=>{let e=t.result,l=await p.A.post("/license",{license:e});1!==l.code?a.Ay.error(l.message):this.getLicense()},t.readAsText(l,"utf-8")}}componentDidMount(){String.prototype.bool=function(){return/^true$/i.test(this)},this.setState({refs:[this.rdpSettingFormRef,this.sshSettingFormRef,this.vncSettingFormRef,this.guacdSettingFormRef,this.mailSettingFormRef,this.logSettingFormRef,this.otherSettingFormRef]},this.getProperties)}render(){return(0,g.jsx)("div",{className:"page-container-white",children:(0,g.jsxs)(r.A,{tabPosition:"left",onChange:this.handleOnTabChange,tabBarStyle:{width:150},children:[(0,g.jsx)(y,{tab:"RDP\u914d\u7f6e",children:(0,g.jsxs)(c.A,{ref:this.rdpSettingFormRef,name:"rdp",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(b,{level:4,children:"RDP\u914d\u7f6e(\u8fdc\u7a0b\u684c\u9762)"}),(0,g.jsx)(c.A.Item,{...v,name:"enable-wallpaper",label:"\u542f\u7528\u684c\u9762\u5899\u7eb8",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"enable-theming",label:"\u542f\u7528\u684c\u9762\u4e3b\u9898",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"enable-font-smoothing",label:"\u542f\u7528\u5b57\u4f53\u5e73\u6ed1\uff08ClearType\uff09",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"enable-full-window-drag",label:"\u542f\u7528\u5168\u7a97\u53e3\u62d6\u62fd",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"enable-desktop-composition",label:"\u542f\u7528\u684c\u9762\u5408\u6210\u6548\u679c\uff08Aero\uff09",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"enable-menu-animations",label:"\u542f\u7528\u83dc\u5355\u52a8\u753b",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"disable-bitmap-caching",label:"\u7981\u7528\u4f4d\u56fe\u7f13\u5b58",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,name:"disable-offscreen-caching",label:"\u7981\u7528\u79bb\u5c4f\u7f13\u5b58",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})},"rdp"),(0,g.jsx)(y,{tab:"TELNET\u914d\u7f6e",children:(0,g.jsxs)(c.A,{ref:this.sshSettingFormRef,name:"ssh",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(b,{level:4,children:"TELNET\u914d\u7f6e"}),(0,g.jsx)(c.A.Item,{...v,name:"color-scheme",label:"\u914d\u8272\u65b9\u6848",rules:[{required:!0,message:"\u914d\u8272\u65b9\u6848"}],initialValue:"gray-black",children:(0,g.jsxs)(n.A,{style:{width:120},onChange:null,children:[(0,g.jsx)(A,{value:"gray-black",children:"\u9ed1\u5e95\u7070\u5b57"}),(0,g.jsx)(A,{value:"green-black",children:"\u9ed1\u5e95\u7eff\u5b57"}),(0,g.jsx)(A,{value:"white-black",children:"\u9ed1\u5e95\u767d\u5b57"}),(0,g.jsx)(A,{value:"black-white",children:"\u767d\u5e95\u9ed1\u5b57"})]})}),(0,g.jsx)(c.A.Item,{...v,name:"font-name",label:"\u5b57\u4f53\u540d\u79f0",rules:[{required:!0,message:"\u5b57\u4f53\u540d\u79f0"}],children:(0,g.jsx)(o.A,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5b57\u4f53\u540d\u79f0"})}),(0,g.jsx)(c.A.Item,{...v,name:"font-size",label:"\u5b57\u4f53\u5927\u5c0f",rules:[{required:!0,message:"\u5b57\u4f53\u5927\u5c0f"}],children:(0,g.jsx)(o.A,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5b57\u4f53\u5927\u5c0f"})}),(0,g.jsx)(c.A.Item,{name:"backspace",label:"\u9000\u683c\u952e\u6620\u5c04",...v,initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u9ed8\u8ba4"}),(0,g.jsx)(A,{value:"127",children:"\u5220\u9664\u952e(Ctrl-?)"}),(0,g.jsx)(A,{value:"8",children:"\u9000\u683c\u952e(Ctrl-H)"})]})}),(0,g.jsx)(c.A.Item,{name:"terminal-type",label:"\u7ec8\u7aef\u7c7b\u578b",...v,initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u9ed8\u8ba4"}),(0,g.jsx)(A,{value:"ansi",children:"ansi"}),(0,g.jsx)(A,{value:"linux",children:"linux"}),(0,g.jsx)(A,{value:"vt100",children:"vt100"}),(0,g.jsx)(A,{value:"vt220",children:"vt220"}),(0,g.jsx)(A,{value:"xterm",children:"xterm"}),(0,g.jsx)(A,{value:"xterm-256color",children:"xterm-256color"})]})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})},"telnet"),(0,g.jsx)(y,{tab:"VNC\u914d\u7f6e",children:(0,g.jsxs)(c.A,{ref:this.vncSettingFormRef,name:"vnc",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(b,{level:4,children:"VNC\u914d\u7f6e"}),(0,g.jsx)(c.A.Item,{...v,name:"color-depth",label:"\u8272\u5f69\u6df1\u5ea6",initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u9ed8\u8ba4"}),(0,g.jsx)(A,{value:"16",children:"\u4f4e\u8272\uff0816\u4f4d\uff09"}),(0,g.jsx)(A,{value:"24",children:"\u771f\u5f69\uff0824\u4f4d\uff09"}),(0,g.jsx)(A,{value:"32",children:"\u771f\u5f69\uff0832\u4f4d\uff09"}),(0,g.jsx)(A,{value:"8",children:"256\u8272"})]})}),(0,g.jsx)(c.A.Item,{...v,name:"cursor",label:"\u5149\u6807",initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u9ed8\u8ba4"}),(0,g.jsx)(A,{value:"local",children:"\u672c\u5730"}),(0,g.jsx)(A,{value:"remote",children:"\u8fdc\u7a0b"})]})}),(0,g.jsx)(c.A.Item,{...v,name:"swap-red-blue",label:"\u4ea4\u6362\u7ea2\u84dd\u6210\u5206",valuePropName:"checked",children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed"})}),(0,g.jsx)(c.A.Item,{...v,label:"\u76ee\u6807\u4e3b\u673a",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u4e3b\u673a\u3002",name:"dest-host",children:(0,g.jsx)(o.A,{placeholder:"\u76ee\u6807\u4e3b\u673a"})}),(0,g.jsx)(c.A.Item,{...v,label:"\u76ee\u6807\u7aef\u53e3",tooltip:"\u8fde\u63a5\u5230VNC\u4ee3\u7406\uff08\u4f8b\u5982UltraVNC Repeater\uff09\u65f6\u8981\u8bf7\u6c42\u7684\u76ee\u6807\u7aef\u53e3\u3002",name:"dest-port",children:(0,g.jsx)(o.A,{type:"number",min:1,max:65535,placeholder:"\u76ee\u6807\u7aef\u53e3"})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})},"vnc"),(0,g.jsxs)(y,{tab:"\u5f55\u5c4f\u914d\u7f6e",children:[(0,g.jsx)(b,{level:4,children:"\u5f55\u5c4f\u914d\u7f6e"}),(0,g.jsxs)(c.A,{ref:this.guacdSettingFormRef,name:"guacd",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(c.A.Item,{...v,name:"enable-recording",label:"\u5f00\u542f\u5f55\u5c4f",valuePropName:"checked",rules:[{required:!0}],children:(0,g.jsx)(h.A,{checkedChildren:"\u5f00\u542f",unCheckedChildren:"\u5173\u95ed",onChange:e=>{this.setState({properties:{...this.state.properties,"enable-recording":e}})}})}),(0,g.jsx)(c.A.Item,{...v,name:"session-saved-limit",label:"\u4f1a\u8bdd\u5f55\u5c4f\u4fdd\u5b58\u65f6\u957f",initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,disabled:!this.state.properties["enable-recording"],children:[(0,g.jsx)(A,{value:"",children:"\u6c38\u4e45"}),(0,g.jsx)(A,{value:"30",children:"30\u5929"}),(0,g.jsx)(A,{value:"60",children:"60\u5929"}),(0,g.jsx)(A,{value:"180",children:"180\u5929"}),(0,g.jsx)(A,{value:"360",children:"360\u5929"})]})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})]},"guacd"),(0,g.jsxs)(y,{tab:"\u90ae\u7bb1\u914d\u7f6e",children:[(0,g.jsx)(b,{level:4,children:"\u90ae\u7bb1\u914d\u7f6e"}),(0,g.jsx)(m.A,{message:"\u914d\u7f6e\u90ae\u7bb1\u540e\uff0c\u6dfb\u52a0\u7528\u6237\u5c06\u5411\u5bf9\u65b9\u7684\u90ae\u7bb1\u53d1\u9001\u8d26\u53f7\u5bc6\u7801\u3002",type:"info",style:{marginBottom:10}}),(0,g.jsxs)(c.A,{ref:this.mailSettingFormRef,name:"mail",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(c.A.Item,{...v,name:"mail-host",label:"\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740",rules:[{required:!1,message:"\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740"}],children:(0,g.jsx)(o.A,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u90ae\u4ef6\u670d\u52a1\u5668\u5730\u5740"})}),(0,g.jsx)(c.A.Item,{...v,name:"mail-port",label:"\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3",rules:[{required:!1,message:"\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3",min:1,max:65535}],children:(0,g.jsx)(o.A,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u90ae\u4ef6\u670d\u52a1\u5668\u7aef\u53e3"})}),(0,g.jsx)(c.A.Item,{...v,name:"mail-username",label:"\u90ae\u7bb1\u8d26\u53f7",rules:[{required:!1,type:"email",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u8d26\u53f7"}],children:(0,g.jsx)(o.A,{type:"email",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u8d26\u53f7"})}),(0,g.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),(0,g.jsx)(c.A.Item,{...v,name:"mail-password",label:"\u90ae\u7bb1\u5bc6\u7801",rules:[{required:!1,message:"\u90ae\u7bb1\u5bc6\u7801"}],children:(0,g.jsx)(o.A,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u5bc6\u7801"})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})]},"mail"),(0,g.jsxs)(y,{tab:"\u65e5\u5fd7\u914d\u7f6e",children:[(0,g.jsx)(b,{level:4,children:"\u65e5\u5fd7\u914d\u7f6e"}),(0,g.jsxs)(c.A,{ref:this.logSettingFormRef,name:"log",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(c.A.Item,{...v,name:"login-log-saved-limit",label:"\u767b\u5f55\u65e5\u5fd7\u4fdd\u7559\u65f6\u957f",initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u6c38\u4e45"}),(0,g.jsx)(A,{value:"30",children:"30\u5929"}),(0,g.jsx)(A,{value:"60",children:"60\u5929"}),(0,g.jsx)(A,{value:"180",children:"180\u5929"}),(0,g.jsx)(A,{value:"360",children:"360\u5929"})]})}),(0,g.jsx)(c.A.Item,{...v,name:"cron-log-saved-limit",label:"\u8ba1\u5212\u4efb\u52a1\u65e5\u5fd7\u4fdd\u7559\u65f6\u957f",initialValue:"",children:(0,g.jsxs)(n.A,{onChange:null,children:[(0,g.jsx)(A,{value:"",children:"\u6c38\u4e45"}),(0,g.jsx)(A,{value:"30",children:"30\u5929"}),(0,g.jsx)(A,{value:"60",children:"60\u5929"}),(0,g.jsx)(A,{value:"180",children:"180\u5929"}),(0,g.jsx)(A,{value:"360",children:"360\u5929"})]})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})]},"log"),(0,g.jsxs)(y,{tab:"\u5176\u4ed6\u914d\u7f6e",children:[(0,g.jsx)(b,{level:4,children:"\u5176\u4ed6\u914d\u7f6e"}),(0,g.jsxs)(c.A,{ref:this.otherSettingFormRef,name:"other",onFinish:this.changeProperties,layout:"vertical",children:[(0,g.jsx)(c.A.Item,{...v,name:"user-default-storage-size",label:"\u7528\u6237\u7a7a\u95f4\u9ed8\u8ba4\u5927\u5c0f",tooltip:"\u65e0\u9650\u5236\u8bf7\u586b\u5199-1",children:(0,g.jsx)(o.A,{type:"number",min:-1,suffix:"MB"})}),(0,g.jsx)(c.A.Item,{...f,children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",children:"\u66f4\u65b0"})})]})]},"other"),(0,g.jsxs)(y,{tab:"\u5907\u4efd\u4e0e\u6062\u590d",children:[(0,g.jsx)(b,{level:4,children:"\u5907\u4efd\u4e0e\u6062\u590d"}),(0,g.jsxs)(u.A,{direction:"vertical",children:[(0,g.jsx)(m.A,{message:"\u6062\u590d\u6570\u636e\u65f6\uff0c\u5982\u5b58\u5728\u767b\u5f55\u8d26\u53f7\u76f8\u540c\u7684\u7528\u6237\u65f6\uff0c\u4f1a\u4fdd\u7559\u539f\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\uff0c\u6b64\u5916\u7531\u4e8e\u767b\u5f55\u5bc6\u7801\u52a0\u5bc6\u4e4b\u540e\u4e0d\u53ef\u9006\uff0c\u6062\u590d\u7684\u8d26\u6237\u5bc6\u7801\u5c06\u968f\u673a\u4ea7\u751f\u3002",type:"info"}),(0,g.jsxs)(u.A,{children:[(0,g.jsx)(d.A,{type:"primary",onClick:()=>{(0,x.RG)("".concat(j.E8,"/backup/export?X-Auth-Token=").concat((0,x.gf)(),"&t=").concat((new Date).getTime()))},children:"\u5bfc\u51fa\u5907\u4efd"}),(0,g.jsx)(d.A,{type:"dashed",loading:this.state.importBtnLoading,onClick:()=>{window.document.getElementById("file-upload").click()},children:"\u6062\u590d\u5907\u4efd"}),(0,g.jsx)("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:this.handleImport})]})]})]},"backup")]})})}}const k=C},27373:(e,l,t)=>{function i(e){return Object.keys(e).reduce((function(l,t){return!t.startsWith("data-")&&!t.startsWith("aria-")&&"role"!==t||t.startsWith("data-__")||(l[t]=e[t]),l}),{})}t.d(l,{A:()=>i})}}]);