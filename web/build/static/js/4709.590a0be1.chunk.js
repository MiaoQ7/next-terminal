"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[4709],{16018:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(93766),s=a(21215),r=a.n(s);class c{constructor(e){this.group="",this.getById=async e=>{let t=await n.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=r().stringify(e),a=await n.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==a.code?{}:a.data},this.getAll=async()=>{let e=await n.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await n.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await n.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await n.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},80398:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(16018),s=a(93766);class r extends n.A{constructor(){var e;super("assets"),e=this,this.GetAll=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=await s.A.get("/".concat(e.group,"?protocol=").concat(t));return 1!==a.code?[]:a.data},this.connTest=async e=>{let t=await s.A.post("/".concat(this.group,"/").concat(e,"/tcping"));return 1!==t.code?[!1,t.message]:[t.data.active,t.data.message]},this.importAsset=async e=>{const t=new FormData;t.append("file",e);let a=await s.A.post("/".concat(this.group,"/import"),t,{"Content-Type":"multipart/form-data"});return 1!==a.code?[!1,a.message]:[!0,a.data]},this.changeOwner=async(e,t)=>1===(await s.A.post("/".concat(this.group,"/").concat(e,"/change-owner?owner=").concat(t))).code}}const c=new r},52142:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(21215),s=a.n(n),r=a(93766);const c=new class{constructor(){this.group="authorised",this.GetAssetPaging=async e=>{let t=s().stringify(e),a=await r.A.get("/".concat(this.group,"/assets/paging?").concat(t));return 1!==a.code?{}:a.data},this.GetUserPaging=async e=>{let t=s().stringify(e),a=await r.A.get("/".concat(this.group,"/users/paging?").concat(t));return 1!==a.code?{}:a.data},this.GetUserGroupPaging=async e=>{let t=s().stringify(e),a=await r.A.get("/".concat(this.group,"/user-groups/paging?").concat(t));return 1!==a.code?{}:a.data},this.AuthorisedAssets=async e=>1===(await r.A.post("/".concat(this.group,"/assets"),e)).code,this.AuthorisedUsers=async e=>1===(await r.A.post("/".concat(this.group,"/users"),e)).code,this.AuthorisedUserGroups=async e=>1===(await r.A.post("/".concat(this.group,"/user-groups"),e)).code,this.GetSelected=async e=>{let t=s().stringify(e),a=await r.A.get("/".concat(this.group,"/selected?").concat(t));return 1!==a.code?[]:a.data},this.DeleteById=async e=>1===(await r.A.delete("/".concat(this.group,"/").concat(e))).code}}},54081:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(16018),s=a(93766);class r extends n.A{constructor(){super("strategies"),this.GetAll=async()=>{let e=await s.A.get("/".concat(this.group));return 1!==e.code?[]:e.data}}}const c=new r},8425:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(16018),s=a(93766);class r extends n.A{constructor(){super("user-groups"),this.GetAll=async()=>{let e=await s.A.get("/".concat(this.group));return 1!==e.code?[]:e.data}}}const c=new r},16623:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(16018),s=a(93766);class r extends n.A{constructor(){super("users"),this.resetTotp=async e=>1===(await s.A.post("/".concat(this.group,"/").concat(e,"/reset-totp"))).code,this.changePassword=async(e,t)=>{let a=new FormData;return a.set("password",t),1===(await s.A.post("/".concat(this.group,"/").concat(e,"/change-password"),a)).code},this.changeStatus=async(e,t)=>1!==(await s.A.patch("/".concat(this.group,"/").concat(e,"/status?status=").concat(t))).code}}const c=new r},44709:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(9950),s=a(28429),r=a(42074),c=a(72381),o=a(80398),l=a(91524),i=a(44414);const d=o.A,u=e=>{let{active:t,id:a}=e,[s,r]=(0,n.useState)({});return(0,n.useEffect)((()=>{t&&a&&(async e=>{let t=await d.getById(e);t&&r(t)})(a)}),[t]),(0,i.jsx)("div",{className:"page-detail-info",children:(0,i.jsxs)(l.A,{column:1,children:[(0,i.jsx)(l.A.Item,{label:"\u8d44\u4ea7\u540d\u79f0",children:s.name}),(0,i.jsx)(l.A.Item,{label:"\u534f\u8bae",children:s.protocol}),(0,i.jsx)(l.A.Item,{label:"IP",children:s.ip}),(0,i.jsx)(l.A.Item,{label:"\u7aef\u53e3",children:s.port}),(0,i.jsx)(l.A.Item,{label:"\u6807\u7b7e",children:s.tags}),(0,i.jsx)(l.A.Item,{label:"\u521b\u5efa\u65f6\u95f4",children:s.created})]})})};var h=a(76702),p=a(48538),m=a(52142),g=a(27666),y=a(87827),A=a(87427),v=a(99674),f=a(8425),b=a(54081);const x={labelCol:{span:6},wrapperCol:{span:14}},w=e=>{let{id:t,visible:a,handleOk:s,handleCancel:r,confirmLoading:c}=e;const[o]=y.A.useForm();let[l,d]=(0,n.useState)([]),[u,h]=(0,n.useState)([]),[p,g]=(0,n.useState)([]);(0,n.useEffect)((()=>{a?async function(){let e={key:"userGroupId",assetId:t},a=await m.A.GetSelected(e);d(a);let n=await f.A.getAll();h(n);let s=await b.A.getAll();g(s)}():o.resetFields()}),[a]);let w=p.map((e=>({value:e.id,label:e.name}))),j=u.map((e=>({value:e.id,label:e.name,disabled:l.includes(e.id)})));return(0,i.jsx)(A.A,{title:"\u7528\u6237\u6388\u6743",visible:a,maskClosable:!1,destroyOnClose:!0,onOk:()=>{o.validateFields().then((async e=>{await s(e)&&o.resetFields()}))},onCancel:()=>{o.resetFields(),r()},confirmLoading:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,i.jsxs)(y.A,{form:o,...x,children:[(0,i.jsx)(y.A.Item,{label:"\u7528\u6237\u7ec4",name:"userGroupIds",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7528\u6237\u7ec4"}],children:(0,i.jsx)(v.A,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u7ec4",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:j})}),(0,i.jsx)(y.A.Item,{label:"\u6388\u6743\u7b56\u7565",name:"strategyId",extra:"\u53ef\u63a7\u5236\u6388\u6743\u7528\u6237\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\u7b49\u529f\u80fd",children:(0,i.jsx)(v.A,{allowClear:!0,style:{width:"100%"},placeholder:"\u6b64\u5b57\u6bb5\u4e0d\u662f\u5fc5\u586b\u7684",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:w})})]})})};var j=a(68201);const C=n.createRef(),I=e=>{let{id:t,active:a}=e,[s,c]=(0,n.useState)(!1),[o,l]=(0,n.useState)(!1);(0,n.useEffect)((()=>{a&&C.current.reload()}),[a]);const d=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u7528\u6237\u7ec4\u540d\u79f0",dataIndex:"userGroupName",render:(e,t)=>(0,i.jsx)(r.N_,{to:"/user-group/".concat(t.userGroupId),children:e})},{title:"\u6388\u6743\u7b56\u7565\u540d\u79f0",dataIndex:"strategyName",hideInSearch:!0,render:(e,t)=>(0,i.jsx)(r.N_,{to:"/strategy/".concat(t.strategyId),children:e})},{title:"\u6388\u6743\u65e5\u671f",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",width:50,render:(e,t,a,n)=>[(0,i.jsx)(j.A,{menu:"asset-authorised-user-group-del",children:(0,i.jsx)("a",{onClick:async()=>{await m.A.DeleteById(t.id),C.current.reload()},children:"\u79fb\u9664"},"unbind")},"unbind-acc")]}];return(0,i.jsxs)("div",{children:[(0,i.jsx)(g.A,{columns:d,actionRef:C,request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,n="",s="";Object.keys(a).length>0&&(n=Object.keys(a)[0],s=Object.values(a)[0]);let r={pageIndex:e.current,pageSize:e.pageSize,name:e.name,assetId:t,field:n,order:s},c=await m.A.GetUserGroupPaging(r);return{data:c.items,success:!0,total:c.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u6388\u6743\u7684\u7528\u6237\u7ec4\u5217\u8868",toolBarRender:()=>[(0,i.jsx)(j.A,{menu:"asset-authorised-user-group-add",children:(0,i.jsx)(p.A,{type:"primary",onClick:()=>{c(!0)},children:"\u6388\u6743"},"button")},"bind-acc")]}),(0,i.jsx)(w,{id:t,visible:s,confirmLoading:o,handleCancel:()=>{c(!1)},handleOk:async e=>{l(!0),e.assetId=t;try{m.A.AuthorisedUserGroups(e)&&c(!1),C.current.reload()}finally{l(!1)}}})]})};var S=a(50070);const{TabPane:k}=c.A,E=()=>{const e=(0,s.g)().assetId,[t,a]=(0,r.ok)();let o=t.get("activeKey");o=o||"info";let[l,d]=(0,n.useState)(o);return(0,i.jsx)("div",{className:"page-detail-warp",children:(0,i.jsxs)(c.A,{activeKey:l,onChange:e=>{d(e),a({activeKey:e})},children:[(0,S.as)("asset-detail")&&(0,i.jsx)(k,{tab:"\u57fa\u672c\u4fe1\u606f",children:(0,i.jsx)(u,{active:"info"===l,id:e})},"info"),(0,S.as)("asset-authorised-user")&&(0,i.jsx)(k,{tab:"\u6388\u6743\u7684\u7528\u6237",children:(0,i.jsx)(h.A,{active:"bind-user"===l,id:e})},"bind-user"),(0,S.as)("asset-authorised-user-group")&&(0,i.jsx)(k,{tab:"\u6388\u6743\u7684\u7528\u6237\u7ec4",children:(0,i.jsx)(I,{active:"bind-user-group"===l,id:e})},"bind-user-group")]})})}},76702:(e,t,a)=>{a.d(t,{A:()=>v});var n=a(9950),s=a(42074),r=a(52142),c=a(27666),o=a(48538),l=a(87827),i=a(87427),d=a(99674),u=a(54081),h=a(16623),p=a(44414);const m={labelCol:{span:6},wrapperCol:{span:14}},g=e=>{let{id:t,visible:a,handleOk:s,handleCancel:c,confirmLoading:o}=e;const[g]=l.A.useForm();let[y,A]=(0,n.useState)([]),[v,f]=(0,n.useState)([]),[b,x]=(0,n.useState)([]);(0,n.useEffect)((()=>{a?async function(){let e={key:"userId",assetId:t},a=await r.A.GetSelected(e);A(a);let n=await h.A.getAll();f(n);let s=await u.A.getAll();x(s)}():g.resetFields()}),[a]);let w=b.map((e=>({value:e.id,label:e.name}))),j=v.map((e=>({value:e.id,label:e.nickname,disabled:y.includes(e.id)})));return(0,p.jsx)(i.A,{title:"\u7528\u6237\u6388\u6743",visible:a,maskClosable:!1,destroyOnClose:!0,onOk:()=>{g.validateFields().then((async e=>{await s(e)&&g.resetFields()}))},onCancel:()=>{g.resetFields(),c()},confirmLoading:o,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,p.jsxs)(l.A,{form:g,...m,children:[(0,p.jsx)(l.A.Item,{label:"\u7528\u6237",name:"userIds",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7528\u6237"}],children:(0,p.jsx)(d.A,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:j})}),(0,p.jsx)(l.A.Item,{label:"\u6388\u6743\u7b56\u7565",name:"strategyId",extra:"\u53ef\u63a7\u5236\u6388\u6743\u7528\u6237\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\u7b49\u529f\u80fd",children:(0,p.jsx)(d.A,{allowClear:!0,style:{width:"100%"},placeholder:"\u6b64\u5b57\u6bb5\u4e0d\u662f\u5fc5\u586b\u7684",showSearch:!0,filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:w})})]})})};var y=a(68201);const A=n.createRef(),v=e=>{let{active:t,id:a}=e,[l,i]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&A.current.reload()}),[t]);const h=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u7528\u6237\u540d\u79f0",dataIndex:"userName",render:(e,t)=>(0,p.jsx)(s.N_,{to:"/user/".concat(t.userId),children:e})},{title:"\u6388\u6743\u7b56\u7565\u540d\u79f0",dataIndex:"strategyName",hideInSearch:!0,render:(e,t)=>(0,p.jsx)(s.N_,{to:"/strategy/".concat(t.strategyId),children:e})},{title:"\u6388\u6743\u65e5\u671f",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",width:50,render:(e,t,a,n)=>[(0,p.jsx)(y.A,{menu:"asset-authorised-user-del",children:(0,p.jsx)("a",{onClick:async()=>{await r.A.DeleteById(t.id),A.current.reload()},children:"\u79fb\u9664"},"unbind")},"unbind-acc")]}];return(0,p.jsxs)("div",{children:[(0,p.jsx)(c.A,{columns:h,actionRef:A,request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n="",s="";Object.keys(t).length>0&&(n=Object.keys(t)[0],s=Object.values(t)[0]);let c={pageIndex:e.current,pageSize:e.pageSize,name:e.name,assetId:a,field:n,order:s},o=await r.A.GetUserPaging(c);return{data:o.items,success:!0,total:o.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u6388\u6743\u7684\u7528\u6237\u5217\u8868",toolBarRender:()=>[(0,p.jsx)(y.A,{menu:"asset-authorised-user-add",children:(0,p.jsx)(o.A,{type:"primary",onClick:()=>{i(!0)},children:"\u6388\u6743"},"button")},"bind-acc")]}),(0,p.jsx)(g,{id:a,visible:l,confirmLoading:d,handleCancel:()=>{i(!1)},handleOk:async e=>{u(!0),e.assetId=a;try{r.A.AuthorisedUsers(e)&&i(!1),A.current.reload()}finally{u(!1)}}})]})}},68201:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(50070);const s=e=>{let{menu:t,children:a}=e;if(Array.isArray(t)){if((0,n.as)(...t))return a}else if((0,n.as)(t))return a}},91524:(e,t,a)=>{a.d(t,{h:()=>f,A:()=>j});var n=a(64467),s=a(5544),r=a(82284),c=a(48738),o=a.n(c),l=a(18909),i=a(9950),d=a(5741),u=a(39156),h=a(86557);const p=function(e){return e.children};var m=a(58168);function g(e){return void 0!==e&&null!==e}const y=function(e){var t,a=e.itemPrefixCls,s=e.component,r=e.span,c=e.className,l=e.style,d=e.labelStyle,u=e.contentStyle,h=e.bordered,p=e.label,m=e.content,y=e.colon,A=s;return h?i.createElement(A,{className:o()((t={},(0,n.A)(t,"".concat(a,"-item-label"),g(p)),(0,n.A)(t,"".concat(a,"-item-content"),g(m)),t),c),style:l,colSpan:r},g(p)&&i.createElement("span",{style:d},p),g(m)&&i.createElement("span",{style:u},m)):i.createElement(A,{className:o()("".concat(a,"-item"),c),style:l,colSpan:r},i.createElement("div",{className:"".concat(a,"-item-container")},(p||0===p)&&i.createElement("span",{className:o()("".concat(a,"-item-label"),(0,n.A)({},"".concat(a,"-item-no-colon"),!y)),style:d},p),(m||0===m)&&i.createElement("span",{className:o()("".concat(a,"-item-content")),style:u},m)))};function A(e,t,a){var n=t.colon,s=t.prefixCls,r=t.bordered,c=a.component,o=a.type,l=a.showLabel,d=a.showContent,u=a.labelStyle,h=a.contentStyle;return e.map((function(e,t){var a=e.props,p=a.label,g=a.children,A=a.prefixCls,v=void 0===A?s:A,f=a.className,b=a.style,x=a.labelStyle,w=a.contentStyle,j=a.span,C=void 0===j?1:j,I=e.key;return"string"===typeof c?i.createElement(y,{key:"".concat(o,"-").concat(I||t),className:f,style:b,labelStyle:(0,m.A)((0,m.A)({},u),x),contentStyle:(0,m.A)((0,m.A)({},h),w),span:C,colon:n,component:c,itemPrefixCls:v,bordered:r,label:l?p:null,content:d?g:null}):[i.createElement(y,{key:"label-".concat(I||t),className:f,style:(0,m.A)((0,m.A)((0,m.A)({},u),b),x),span:1,colon:n,component:c[0],itemPrefixCls:v,bordered:r,label:p}),i.createElement(y,{key:"content-".concat(I||t),className:f,style:(0,m.A)((0,m.A)((0,m.A)({},h),b),w),span:2*C-1,component:c[1],itemPrefixCls:v,bordered:r,content:g})]}))}const v=function(e){var t=i.useContext(f),a=e.prefixCls,n=e.vertical,s=e.row,r=e.index,c=e.bordered;return n?i.createElement(i.Fragment,null,i.createElement("tr",{key:"label-".concat(r),className:"".concat(a,"-row")},A(s,e,(0,m.A)({component:"th",type:"label",showLabel:!0},t))),i.createElement("tr",{key:"content-".concat(r),className:"".concat(a,"-row")},A(s,e,(0,m.A)({component:"td",type:"content",showContent:!0},t)))):i.createElement("tr",{key:r,className:"".concat(a,"-row")},A(s,e,(0,m.A)({component:c?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))};var f=i.createContext({}),b={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function x(e,t,a){var n=e;return(void 0===t||t>a)&&(n=(0,u.Ob)(e,{span:a})),n}function w(e){var t,a=e.prefixCls,c=e.title,u=e.extra,p=e.column,m=void 0===p?b:p,g=e.colon,y=void 0===g||g,A=e.bordered,w=e.layout,j=e.children,C=e.className,I=e.style,S=e.size,k=e.labelStyle,E=e.contentStyle,N=i.useContext(d.QO),O=N.getPrefixCls,G=N.direction,L=O("descriptions",a),P=i.useState({}),F=(0,s.A)(P,2),T=F[0],B=F[1],U=function(e,t){if("number"===typeof e)return e;if("object"===(0,r.A)(e))for(var a=0;a<h.ye.length;a++){var n=h.ye[a];if(t[n]&&void 0!==e[n])return e[n]||b[n]}return 3}(m,T);i.useEffect((function(){var e=h.Ay.subscribe((function(e){"object"===(0,r.A)(m)&&B(e)}));return function(){h.Ay.unsubscribe(e)}}),[]);var z=function(e,t){var a=(0,l.A)(e).filter((function(e){return e})),n=[],s=[],r=t;return a.forEach((function(e,c){var o,l=null===(o=e.props)||void 0===o?void 0:o.span,i=l||1;if(c===a.length-1)return s.push(x(e,l,r)),void n.push(s);i<r?(r-=i,s.push(e)):(s.push(x(e,i,r)),n.push(s),r=t,s=[])})),n}(j,U),R=i.useMemo((function(){return{labelStyle:k,contentStyle:E}}),[k,E]);return i.createElement(f.Provider,{value:R},i.createElement("div",{className:o()(L,(t={},(0,n.A)(t,"".concat(L,"-").concat(S),S&&"default"!==S),(0,n.A)(t,"".concat(L,"-bordered"),!!A),(0,n.A)(t,"".concat(L,"-rtl"),"rtl"===G),t),C),style:I},(c||u)&&i.createElement("div",{className:"".concat(L,"-header")},c&&i.createElement("div",{className:"".concat(L,"-title")},c),u&&i.createElement("div",{className:"".concat(L,"-extra")},u)),i.createElement("div",{className:"".concat(L,"-view")},i.createElement("table",null,i.createElement("tbody",null,z.map((function(e,t){return i.createElement(v,{key:t,index:t,colon:y,prefixCls:L,vertical:"vertical"===w,bordered:A,row:e})})))))))}w.Item=p;const j=w}}]);