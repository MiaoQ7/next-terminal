"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[6004],{16018:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(93766),n=s(21215),r=s.n(n);class c{constructor(e){this.group="",this.getById=async e=>{let t=await a.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=r().stringify(e),s=await a.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==s.code?{}:s.data},this.getAll=async()=>{let e=await a.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await a.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await a.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await a.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},8425:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(16018),n=s(93766);class r extends a.A{constructor(){super("user-groups"),this.GetAll=async()=>{let e=await n.A.get("/".concat(this.group));return 1!==e.code?[]:e.data}}}const c=new r},16623:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(16018),n=s(93766);class r extends a.A{constructor(){super("users"),this.resetTotp=async e=>1===(await n.A.post("/".concat(this.group,"/").concat(e,"/reset-totp"))).code,this.changePassword=async(e,t)=>{let s=new FormData;return s.set("password",t),1===(await n.A.post("/".concat(this.group,"/").concat(e,"/change-password"),s)).code},this.changeStatus=async(e,t)=>1!==(await n.A.patch("/".concat(this.group,"/").concat(e,"/status?status=").concat(t))).code}}const c=new r},13626:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(9950),n=s(68832),r=s(56231),c=s(48538),i=s(43151),o=s(27666),l=s(87827),d=s(87427),u=s(55902),h=s(99674),g=s(8425),p=s(16623),A=s(41920),m=s(98409),y=s(44414);const x=g.A,S={labelCol:{span:6},wrapperCol:{span:14}},f=e=>{let{visible:t,handleOk:s,handleCancel:a,confirmLoading:n,id:r}=e;const[c]=l.A.useForm();(0,A.useQuery)("userGroupQuery",(()=>x.getById(r)),{enabled:t&&m.A.hasText(r),onSuccess:e=>{e.members=e.members.map((e=>e.id)),c.setFieldsValue(e)}});let i=(0,A.useQuery)("usersQuery",p.A.getAll,{enabled:t}).data||[];return(0,y.jsx)(d.A,{title:r?"\u66f4\u65b0\u7528\u6237\u7ec4":"\u65b0\u5efa\u7528\u6237\u7ec4",visible:t,maskClosable:!1,destroyOnClose:!0,onOk:()=>{c.validateFields().then((async e=>{await s(e)&&c.resetFields()}))},onCancel:()=>{c.resetFields(),a()},confirmLoading:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,y.jsxs)(l.A,{form:c,...S,children:[(0,y.jsx)(l.A.Item,{name:"id",noStyle:!0,children:(0,y.jsx)(u.A,{hidden:!0})}),(0,y.jsx)(l.A.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"}],children:(0,y.jsx)(u.A,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u7ec4\u540d\u79f0"})}),(0,y.jsx)(l.A.Item,{label:"\u7528\u6237\u7ec4\u6210\u5458",name:"members",children:(0,y.jsx)(h.A,{showSearch:!0,mode:"multiple",allowClear:!0,placeholder:"\u7528\u6237\u7ec4\u6210\u5458",filterOption:!1,children:i.map((e=>(0,y.jsx)(h.A.Option,{value:e.id,children:e.nickname},e.id)))})})]})})};var C=s(28429),j=s(42074),w=s(27891),v=s(50070),O=s(68201);const I=g.A,{Content:k}=n.A,E=a.createRef(),b=()=>{let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[l,d]=(0,a.useState)(void 0);const[u,h]=(0,w.j)(w.A.USER_GROUP);let g=(0,C.Zp)();const p=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u540d\u79f0",dataIndex:"name",render:(e,t)=>{let s=(0,y.jsx)("div",{children:e});return(0,v.as)("user-group-detail")&&(s=(0,y.jsx)(j.N_,{to:"/user-group/".concat(t.id),children:e})),s}},{title:"\u521b\u5efa\u65f6\u95f4",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:(e,s,a,n)=>[(0,y.jsx)(O.A,{menu:"user-group-edit",children:(0,y.jsx)("a",{onClick:()=>{t(!0),d(s.id)},children:"\u7f16\u8f91"},"edit")},"user-group-edit"),(0,y.jsx)(O.A,{menu:"user-group-del",children:(0,y.jsx)(r.A,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u884c\u5417?",onConfirm:async()=>{await I.deleteById(s.id),E.current.reload()},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,y.jsx)("a",{className:"danger",children:"\u5220\u9664"},"delete")},"confirm-delete")},"user-group-del"),(0,y.jsx)(i.A,{onSelect:e=>{switch(e){case"user-group-detail":g("/user-group/".concat(s.id,"?activeKey=info"));break;case"user-group-authorised-asset":g("/user-group/".concat(s.id,"?activeKey=asset"))}},menus:[{key:"user-group-detail",name:"\u8be6\u60c5",disabled:!(0,v.as)("user-group-detail")},{key:"user-group-authorised-asset",name:"\u6388\u6743\u8d44\u4ea7",disabled:!(0,v.as)("user-group-authorised-asset")}]},"actionGroup")]}];return(0,y.jsxs)(k,{className:"page-container",children:[(0,y.jsx)(o.A,{columns:p,actionRef:E,columnsState:{value:u,onChange:h},request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s="",a="";Object.keys(t).length>0&&(s=Object.keys(t)[0],a=Object.values(t)[0]);let n={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:s,order:a},r=await I.getPaging(n);return{data:r.items,success:!0,total:r.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u7528\u6237\u7ec4\u5217\u8868",toolBarRender:()=>[(0,y.jsx)(O.A,{menu:"user-group-add",children:(0,y.jsx)(c.A,{type:"primary",onClick:()=>{t(!0)},children:"\u65b0\u5efa"},"button")})]}),(0,y.jsx)(f,{id:l,visible:e,confirmLoading:s,handleCancel:()=>{t(!1),d(void 0)},handleOk:async e=>{n(!0);try{let s;s=e.id?await I.updateById(e.id,e):await I.create(e),s&&t(!1),E.current.reload()}finally{n(!1)}}})]})}},68201:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(50070);const n=e=>{let{menu:t,children:s}=e;if(Array.isArray(t)){if((0,a.as)(...t))return s}else if((0,a.as)(t))return s}},27891:(e,t,s)=>{s.d(t,{A:()=>c,j:()=>i});var a=s(98409),n=s(9950);let r=new class{constructor(){this.ASSET="cs-asset",this.CREDENTIAL="cs-credential",this.COMMAND="cs-command",this.ACCESS_GATEWAY="cs-access-gateway",this.ONLINE_SESSION="cs-online-session",this.OFFLINE_SESSION="cs-offline-session",this.LOGIN_LOG="cs-login-log",this.STORAGE_LOG="cs-storage-log",this.JOB="cs-job",this.STORAGE="cs-storage",this.LOGIN_POLICY="cs-login-policy",this.ACCESS_SECURITY="cs-access-security",this.USER="cs-user",this.ROLE="cs-role",this.USER_GROUP="cs-user-group",this.COMMAND_FILTER="cs-command-filter",this.STRATEGY="cs-strategy"}};const c=r,i=e=>{let[t,s]=(0,n.useState)(o(e));return[t,t=>{new Promise((e=>{s(t),e(t)})).then((t=>{l(e,t)}))}]},o=e=>{switch(e){case r.ASSET:case r.CREDENTIAL:case r.COMMAND:case r.ACCESS_GATEWAY:case r.ONLINE_SESSION:case r.OFFLINE_SESSION:}return d(e,{})},l=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},d=(e,t)=>{let s=localStorage.getItem(e);if(!a.A.hasText(s))return t;try{return JSON.parse(s)}catch(n){return t}}},98409:(e,t,s)=>{s.d(t,{A:()=>a});const a=new class{constructor(){this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){let s=e.toString();for(;s.length<t;)s="0"+s;return s}}}},43151:(e,t,s)=>{s.d(t,{A:()=>y});var a=s(89379),n=s(53986),r=(s(27361),s(48538)),c=(s(84490),s(57811)),i=(s(53552),s(69216)),o=(s(93481),s(4122)),l=s(44414),d=s(94889),u=s(55067),h=s(48738),g=s.n(h),p=s(9950);s.p;var A=["key","name"],m=function(e){var t=e.className,s=e.style,r=e.onSelect,d=e.menus,h=void 0===d?[]:d,m=e.children,y=(0,(0,p.useContext)(o.Ay.ConfigContext).getPrefixCls)("pro-table-dropdown"),x=(0,l.jsx)(i.A,{onClick:function(e){null===r||void 0===r||r(e.key)},items:h.map((function(e){var t=e.key,s=e.name,r=(0,n.A)(e,A);return(0,a.A)((0,a.A)({key:t},r),{},{title:r.title,label:s})}))});return(0,l.jsx)(c.A,{overlay:x,className:g()(y,t),children:(0,l.jsx)("a",{style:s,children:m||(0,l.jsx)(u.A,{})})})};m.Button=function(e){var t=e.children,s=e.menus,a=e.onSelect,n=e.className,u=e.style,h=(0,(0,p.useContext)(o.Ay.ConfigContext).getPrefixCls)("pro-table-dropdown"),A=(0,l.jsx)(i.A,{onClick:function(e){return a&&a(e.key)},items:null===s||void 0===s?void 0:s.map((function(e){return{label:e.name,key:e.key}}))});return(0,l.jsx)(c.A,{overlay:A,className:g()(h,n),children:(0,l.jsxs)(r.A,{style:u,children:[t," ",(0,l.jsx)(d.A,{})]})})};const y=m}}]);