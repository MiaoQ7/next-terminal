"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[6491],{16018:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(93766),a=s(21215),n=s.n(a);class r{constructor(e){this.group="",this.getById=async e=>{let t=await i.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=n().stringify(e),s=await i.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==s.code?{}:s.data},this.getAll=async()=>{let e=await i.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await i.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await i.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await i.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},60715:(e,t,s)=>{s.d(t,{A:()=>G});var i=s(9950),a=s(50559),n=s(87427),r=s(92759),l=s(54175),c=s(1158),o=s(48538),d=s(56231),h=s(55902),m=s(80737),u=s(52735),p=s(2557),g=s(84703),f=s(87827),A=s(31023),y=s(26142),x=s(39742),v=s(94500),j=s(2835),w=s(56149),k=s(42025),b=s(47738),I=s(46995),S=s(20735),C=s(87621),z=s(9313),F=s(51598),N=s(37866),E=s(44070),L=s(27379),O=s(21215),T=s.n(O),B=s(93766),V=s(39608),R=s(27646),H=s(83813),M=s(44414);const D=(0,i.lazy)((()=>s.e(1092).then(s.bind(s,81092)))),{Text:P}=a.A,q=n.A.confirm;class K extends i.Component{constructor(){super(...arguments),this.mkdirFormRef=i.createRef(),this.renameFormRef=i.createRef(),this.state={storageType:void 0,storageId:void 0,currentDirectory:"/",currentDirectoryInput:"/",files:[],loading:!1,currentFileKey:void 0,selectedRowKeys:[],uploading:{},callback:void 0,minHeight:280,upload:!1,download:!1,delete:!1,rename:!1,edit:!1,editorVisible:!1,fileName:"",fileContent:""},this.reSetStorageId=e=>{this.setState({storageId:e},(()=>{this.loadFiles("/")}))},this.refresh=async()=>{this.loadFiles(this.state.currentDirectory),this.state.callback&&this.state.callback()},this.loadFiles=async e=>{this.setState({loading:!0});try{(0,R.Im)(e)&&(e="/");let t=new FormData;t.append("dir",e);let s=await B.A.post("/".concat(this.state.storageType,"/").concat(this.state.storageId,"/ls"),t);if(1!==s.code)return void r.Ay.error(s.message);const i=s.data.map((e=>({key:e.path,...e}))),a=(e,t)=>{let s=e.name.toUpperCase(),i=t.name.toUpperCase();return s<i?-1:s>i?1:0};let n=i.filter((e=>!0===e.isDir));n.sort(a);let l=i.filter((e=>!1===e.isDir));l.sort(a),n.push(...l),"/"!==e&&n.splice(0,0,{key:"..",name:"..",path:"..",isDir:!0,disabled:!0}),this.setState({files:n,currentDirectory:e,currentDirectoryInput:e})}finally{this.setState({loading:!1,selectedRowKeys:[]})}},this.handleCurrentDirectoryInputChange=e=>{this.setState({currentDirectoryInput:e.target.value})},this.handleCurrentDirectoryInputPressEnter=e=>{this.loadFiles(e.target.value)},this.handleUploadDir=()=>{let e=window.document.getElementById("dir-upload").files,t=0;for(let s=0;s<e.length;s++){let i=e[s].webkitRelativePath,a=i.substring(0,i.length-e[s].name.length);this.uploadFile(e[s],this.state.currentDirectory+"/"+a,(()=>{t++,t===e.length&&this.refresh()}))}},this.handleUploadFile=()=>{let e=window.document.getElementById("file-upload").files,t=0;for(let s=0;s<e.length;s++){const i=e[s];if(!i)return;this.uploadFile(i,this.state.currentDirectory,(()=>{t++,t===e.length&&this.refresh()}))}},this.uploadFile=(e,t,s)=>{const{name:a,size:n}=e;let o="".concat(V.E8,"/").concat(this.state.storageType,"/").concat(this.state.storageId,"/upload?X-Auth-Token=").concat((0,R.gf)(),"&dir=").concat(t);const d=a,h=new XMLHttpRequest;let m=0,u=0;const p=(e,t)=>{if(e){let e=(0,M.jsxs)(i.Fragment,{children:[(0,M.jsx)("div",{children:a}),(0,M.jsxs)("div",{children:[(0,R.qI)(n)," / ",(0,R.qI)(n)]}),(0,M.jsx)(l.A,{percent:100})]});c.A.success({key:d,message:"\u4e0a\u4f20\u6210\u529f",duration:5,description:e,placement:"bottomRight"}),s&&s()}else{let e=(0,M.jsxs)(i.Fragment,{children:[(0,M.jsx)("div",{children:a}),(0,M.jsx)(P,{type:"danger",children:t})]});c.A.error({key:d,message:"\u4e0a\u4f20\u5931\u8d25",duration:10,description:e,placement:"bottomRight"})}};h.upload.addEventListener("progress",(e=>{if(e.lengthComputable){let t=(0,M.jsxs)(i.Fragment,{children:[(0,M.jsx)("div",{children:a}),(0,M.jsxs)("div",{children:[(0,R.qI)(e.loaded),"/",(0,R.qI)(n)]}),(0,M.jsx)(l.A,{percent:99})]});if(e.loaded===e.total)return void c.A.info({key:d,message:"\u5411\u76ee\u6807\u673a\u5668\u4f20\u8f93\u4e2d...",duration:null,description:t,placement:"bottomRight",onClose:()=>{h.abort(),r.Ay.info('\u60a8\u5df2\u53d6\u6d88\u4e0a\u4f20"'.concat(a,'"'),10)}});if(u=Math.min(Math.floor(100*e.loaded/e.total),99),m===u)return;t=(0,M.jsxs)(i.Fragment,{children:[(0,M.jsx)("div",{children:a}),(0,M.jsxs)("div",{children:[(0,R.qI)(e.loaded)," / ",(0,R.qI)(n)]}),(0,M.jsx)(l.A,{percent:u})]}),c.A.info({key:d,message:"\u4e0a\u4f20\u4e2d...",duration:null,description:t,placement:"bottomRight",onClose:()=>{h.abort(),r.Ay.info('\u60a8\u5df2\u53d6\u6d88\u4e0a\u4f20"'.concat(a,'"'),10)}}),m=u}}),!1),h.onreadystatechange=e=>{if(4===h.readyState)h.status>=200&&h.status<300?p(!0,"\u4e0a\u4f20\u6210\u529f"):h.status>=400&&h.status<500&&p(!1,"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef");else{let t=e.currentTarget.responseText.split("\u32a5").filter((e=>""!==e));if(t.length>0){let e=t[t.length-1],s=parseInt(e);u=Math.min(Math.floor(100*s/n),99);let o=(0,M.jsxs)(i.Fragment,{children:[(0,M.jsx)("div",{children:a}),(0,M.jsxs)("div",{children:[(0,R.qI)(s),"/",(0,R.qI)(n)]}),(0,M.jsx)(l.A,{percent:u})]});c.A.info({key:d,message:"\u5411\u76ee\u6807\u673a\u5668\u4f20\u8f93\u4e2d...",duration:null,description:o,placement:"bottomRight",onClose:()=>{h.abort(),r.Ay.info('\u60a8\u5df2\u53d6\u6d88\u4e0a\u4f20"'.concat(a,'"'),10)}})}}},h.onerror=()=>{p(!1,"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef")},h.open("POST",o,!0);let g=new FormData;g.append("file",e,a),h.send(g)},this.delete=async e=>{let t=new FormData;t.append("file",e);let s=await B.A.post("/".concat(this.state.storageType,"/").concat(this.state.storageId,"/rm"),t);1!==s.code&&r.Ay.error(s.message)},this.showEditor=async(e,t)=>{r.Ay.loading({key:t,content:"Loading"});let s=await B.A.get("".concat(V.E8,"/").concat(this.state.storageType,"/").concat(this.state.storageId,"/download?file=").concat(window.encodeURIComponent(t),"&t=").concat((new Date).getTime()));this.setState({currentFileKey:t,fileName:e,fileContent:s,editorVisible:!0}),r.Ay.destroy(t)},this.hideEditor=()=>{this.setState({editorVisible:!1,fileName:"",fileContent:"",currentFileKey:""})},this.edit=async()=>{this.setState({confirmLoading:!0});let e="".concat(V.E8,"/").concat(this.state.storageType,"/").concat(this.state.storageId,"/edit"),t=new FormData;t.append("file",this.state.currentFileKey),t.append("fileContent",this.state.fileContent);let s=await B.A.post(e,t);1!==s.code&&r.Ay.error(s.message),this.setState({confirmLoading:!1}),this.hideEditor()}}componentDidMount(){this.props.onRef&&this.props.onRef(this),this.props.storageId&&this.setState({storageId:this.props.storageId,storageType:this.props.storageType,callback:this.props.callback,minHeight:this.props.minHeight,upload:this.props.upload,download:this.props.download,delete:this.props.delete,rename:this.props.rename,edit:this.props.edit},(()=>{this.loadFiles(this.state.currentDirectory)}))}render(){const e=[{title:"\u540d\u79f0",dataIndex:"name",key:"name",render:(e,t)=>{let s;if(t.isDir)s=(0,M.jsx)(A.A,{});else if(t.isLink)s=(0,M.jsx)(y.A,{});else{switch(t.name.split(".").pop().toLowerCase()){case"doc":case"docx":s=(0,M.jsx)(x.A,{});break;case"xls":case"xlsx":s=(0,M.jsx)(v.A,{});break;case"bmp":case"jpg":case"jpeg":case"png":case"tif":case"gif":case"pcx":case"tga":case"exif":case"svg":case"psd":case"ai":case"webp":s=(0,M.jsx)(j.A,{});break;case"md":s=(0,M.jsx)(w.A,{});break;case"pdf":s=(0,M.jsx)(k.A,{});break;case"txt":s=(0,M.jsx)(b.A,{});break;case"zip":case"gz":case"tar":case"tgz":s=(0,M.jsx)(I.A,{});break;default:s=(0,M.jsx)(S.A,{})}}return(0,M.jsxs)("span",{className:"dode",children:[s,"\xa0\xa0",t.name]})},sorter:(e,t)=>".."===e.key||".."===t.key?0:e.name.localeCompare(t.name),sortDirections:["descend","ascend"]},{title:"\u5927\u5c0f",dataIndex:"size",key:"size",render:(e,t)=>t.isDir||t.isLink?(0,M.jsx)("span",{className:"dode"}):(0,M.jsx)("span",{className:"dode",children:(0,R.qI)(e)}),sorter:(e,t)=>".."===e.key||".."===t.key?0:e.size-t.size},{title:"\u4fee\u6539\u65e5\u671f",dataIndex:"modTime",key:"modTime",sorter:(e,t)=>".."===e.key||".."===t.key?0:e.modTime.localeCompare(t.modTime),sortDirections:["descend","ascend"],render:(e,t)=>(0,M.jsx)("span",{className:"dode",children:e})},{title:"\u5c5e\u6027",dataIndex:"mode",key:"mode",render:(e,t)=>(0,M.jsx)("span",{className:"dode",children:e})},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",width:210,render:(e,t)=>{if(".."===t.key)return;let s=!this.state.download,i=!this.state.edit;return(t.isDir||t.isLink)&&(s=!0,i=!0),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.A,{type:"link",size:"small",disabled:i,onClick:()=>this.showEditor(t.name,t.key),children:"\u7f16\u8f91"}),(0,M.jsx)(o.A,{type:"link",size:"small",disabled:s,onClick:async()=>{(0,R.RG)("".concat(V.E8,"/").concat(this.state.storageType,"/").concat(this.state.storageId,"/download?file=").concat(window.encodeURIComponent(t.key),"&X-Auth-Token=").concat((0,R.gf)(),"&t=").concat((new Date).getTime()))},children:"\u4e0b\u8f7d"}),(0,M.jsx)(o.A,{type:"link",size:"small",disabled:!this.state.rename,onClick:()=>{this.setState({renameVisible:!0,currentFileKey:t.key})},children:"\u91cd\u547d\u540d"}),(0,M.jsx)(d.A,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u6587\u4ef6\u5417?",onConfirm:async()=>{await this.delete(t.key),await this.refresh()},okText:"\u662f",cancelText:"\u5426",children:(0,M.jsx)(o.A,{type:"link",size:"small",disabled:!this.state.delete,danger:!0,children:"\u5220\u9664"})})]})}}],{selectedRowKeys:t}=this.state,s={selectedRowKeys:t,onChange:e=>{this.setState({selectedRowKeys:e})},getCheckboxProps:e=>({disabled:e.disabled})};let a=t.length>0;a&&(this.state.delete||(a=!1));const l=(0,M.jsxs)("div",{className:"fs-header",children:[(0,M.jsx)("div",{className:"fs-header-left",children:(0,M.jsx)(h.A,{value:this.state.currentDirectoryInput,onChange:this.handleCurrentDirectoryInputChange,onPressEnter:this.handleCurrentDirectoryInputPressEnter})}),(0,M.jsx)("div",{className:"fs-header-right",children:(0,M.jsxs)(m.A,{children:[(0,M.jsx)("div",{className:"fs-header-right-item",children:(0,M.jsx)(u.A,{title:"\u521b\u5efa\u6587\u4ef6\u5939",children:(0,M.jsx)(o.A,{type:"primary",size:"small",disabled:!this.state.upload,icon:(0,M.jsx)(C.A,{}),onClick:()=>{this.setState({mkdirVisible:!0})},ghost:!0})})}),(0,M.jsx)("div",{className:"fs-header-right-item",children:(0,M.jsxs)(u.A,{title:"\u4e0a\u4f20\u6587\u4ef6",children:[(0,M.jsx)(o.A,{type:"primary",size:"small",icon:(0,M.jsx)(z.A,{}),disabled:!this.state.upload,onClick:()=>{window.document.getElementById("file-upload").click()},ghost:!0}),(0,M.jsx)("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:this.handleUploadFile,multiple:!0})]})}),(0,M.jsx)("div",{className:"fs-header-right-item",children:(0,M.jsxs)(u.A,{title:"\u4e0a\u4f20\u6587\u4ef6\u5939",children:[(0,M.jsx)(o.A,{type:"primary",size:"small",icon:(0,M.jsx)(F.A,{}),disabled:!this.state.upload,onClick:()=>{window.document.getElementById("dir-upload").click()},ghost:!0}),(0,M.jsx)("input",{type:"file",id:"dir-upload",style:{display:"none"},onChange:this.handleUploadDir,webkitdirectory:"",multiple:!0})]})}),(0,M.jsx)("div",{className:"fs-header-right-item",children:(0,M.jsx)(u.A,{title:"\u5237\u65b0",children:(0,M.jsx)(o.A,{type:"primary",size:"small",icon:(0,M.jsx)(N.A,{}),onClick:this.refresh,ghost:!0})})}),(0,M.jsx)("div",{className:"fs-header-right-item",children:(0,M.jsx)(u.A,{title:"\u6279\u91cf\u5220\u9664",children:(0,M.jsx)(o.A,{type:"primary",size:"small",ghost:!0,danger:!0,disabled:!a,icon:(0,M.jsx)(E.A,{}),loading:this.state.delBtnLoading,onClick:()=>{let e=this.state.selectedRowKeys;const t=(0,M.jsxs)("div",{children:["\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684",(0,M.jsx)(P,{style:{color:"#1890FF"},strong:!0,children:e.length}),"\u6761\u8bb0\u5f55\u5417\uff1f"]});q({icon:(0,M.jsx)(L.A,{}),content:t,onOk:async()=>{for(let t=0;t<e.length;t++)".."!==e[t]&&await this.delete(e[t]);this.refresh()},onCancel(){}})}})})})]})})]});return(0,M.jsxs)("div",{children:[(0,M.jsx)(p.A,{title:l,bordered:!0,size:"small",style:{minHeight:this.state.minHeight},children:(0,M.jsx)(g.A,{columns:e,rowSelection:s,dataSource:this.state.files,size:"small",pagination:!1,loading:this.state.loading,onRow:e=>({onDoubleClick:t=>{if(e.isDir||e.isLink)if(".."===e.path){let e=this.state.currentDirectory,t=e.substring(0,e.lastIndexOf("/"));this.loadFiles(t)}else this.loadFiles(e.path)}})})}),this.state.mkdirVisible?(0,M.jsx)(n.A,{title:"\u521b\u5efa\u6587\u4ef6\u5939",visible:this.state.mkdirVisible,okButtonProps:{form:"mkdir-form",key:"submit",htmlType:"submit"},onOk:()=>{this.mkdirFormRef.current.validateFields().then((async e=>{this.mkdirFormRef.current.resetFields();let t={dir:this.state.currentDirectory+"/"+e.dir},s=T().stringify(t);this.setState({confirmLoading:!0});let i=await B.A.post("/".concat(this.state.storageType,"/").concat(this.state.storageId,"/mkdir?").concat(s));1===i.code?(r.Ay.success("\u521b\u5efa\u6210\u529f"),this.loadFiles(this.state.currentDirectory)):r.Ay.error(i.message),this.setState({confirmLoading:!1,mkdirVisible:!1})})).catch((e=>{}))},confirmLoading:this.state.confirmLoading,onCancel:()=>{this.setState({mkdirVisible:!1})},children:(0,M.jsx)(f.A,{ref:this.mkdirFormRef,id:"mkdir-form",children:(0,M.jsx)(f.A.Item,{name:"dir",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"}],children:(0,M.jsx)(h.A,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"})})})}):void 0,this.state.renameVisible?(0,M.jsx)(n.A,{title:"\u91cd\u547d\u540d",visible:this.state.renameVisible,okButtonProps:{form:"rename-form",key:"submit",htmlType:"submit"},onOk:()=>{this.renameFormRef.current.validateFields().then((async e=>{this.renameFormRef.current.resetFields();try{let t=this.state.currentDirectory;t.endsWith("/")||(t+="/");let s={oldName:this.state.currentFileKey,newName:t+e.newName};if(s.oldName===s.newName)return void r.Ay.success("\u91cd\u547d\u540d\u6210\u529f");let i=T().stringify(s);this.setState({confirmLoading:!0});let a=await B.A.post("/".concat(this.state.storageType,"/").concat(this.state.storageId,"/rename?").concat(i));1===a.code?(r.Ay.success("\u91cd\u547d\u540d\u6210\u529f"),this.refresh()):r.Ay.error(a.message)}finally{this.setState({confirmLoading:!1,renameVisible:!1})}})).catch((e=>{}))},confirmLoading:this.state.confirmLoading,onCancel:()=>{this.setState({renameVisible:!1})},children:(0,M.jsx)(f.A,{id:"rename-form",ref:this.renameFormRef,initialValues:{newName:(0,R.WP)(this.state.currentFileKey)},children:(0,M.jsx)(f.A.Item,{name:"newName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u7684\u540d\u79f0"}],children:(0,M.jsx)(h.A,{autoComplete:"off",placeholder:"\u65b0\u7684\u540d\u79f0"})})})}):void 0,(0,M.jsx)(n.A,{title:"\u7f16\u8f91 "+this.state.fileName,className:"modal-no-padding",visible:this.state.editorVisible,destroyOnClose:!0,width:.8*window.innerWidth,centered:!0,okButtonProps:{form:"rename-form",key:"submit",htmlType:"submit"},onOk:this.edit,confirmLoading:this.state.confirmLoading,onCancel:this.hideEditor,children:(0,M.jsx)(i.Suspense,{fallback:(0,M.jsx)(H.A,{}),children:(0,M.jsx)(D,{language:"javascript",height:.8*window.innerHeight,theme:"vs-dark",value:this.state.fileContent,options:{selectOnLineNumbers:!0},editorDidMount:(e,t)=>{e.focus()},editorWillUnmount:()=>{},onChange:(e,t)=>{this.setState({fileContent:e})}})})})]})}}const G=K},66491:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var i=s(9950),a=s(68832),n=s(12916),r=s(56231),l=s(48538),c=s(99019),o=s(27666),d=s(16018);class h extends d.A{constructor(){super("storages")}}const m=new h;var u=s(87827),p=s(99674),g=s(87427),f=s(55902),A=s(43637),y=s(6579),x=s(27646),v=s(41920),j=s(98409),w=s(44414);const k={labelCol:{span:6},wrapperCol:{span:14}},b=e=>{let{visible:t,handleOk:s,handleCancel:a,confirmLoading:n,id:r}=e;const[l]=u.A.useForm();(0,v.useQuery)("getStorageById",(()=>m.getById(r)),{enabled:t&&j.A.hasText(r),onSuccess:e=>{if(e.limitSize>0){let t=(0,x.qI)(e.limitSize).split(" ");e.limitSize=parseInt(t[0]),o(t[1])}else e.limitSize=-1;l.setFieldsValue(e)}});let[c,o]=(0,i.useState)("MB");const d=(0,w.jsxs)(p.A,{value:c,style:{width:65},onChange:e=>{o(e)},children:[(0,w.jsx)(p.A.Option,{value:"B",children:"B"}),(0,w.jsx)(p.A.Option,{value:"KB",children:"KB"}),(0,w.jsx)(p.A.Option,{value:"MB",children:"MB"}),(0,w.jsx)(p.A.Option,{value:"GB",children:"GB"}),(0,w.jsx)(p.A.Option,{value:"TB",children:"TB"}),(0,w.jsx)(p.A.Option,{value:"PB",children:"PB"}),(0,w.jsx)(p.A.Option,{value:"EB",children:"EB"}),(0,w.jsx)(p.A.Option,{value:"ZB",children:"ZB"}),(0,w.jsx)(p.A.Option,{value:"YB",children:"YB"})]});return(0,w.jsx)(g.A,{title:r?"\u66f4\u65b0\u78c1\u76d8\u7a7a\u95f4":"\u65b0\u5efa\u78c1\u76d8\u7a7a\u95f4",visible:t,maskClosable:!1,destroyOnClose:!0,onOk:()=>{l.validateFields().then((async e=>{let t=e.limitSize;switch(c){case"B":default:break;case"KB":t*=1024;break;case"MB":t=1024*t*1024;break;case"GB":t=1024*t*1024*1024;break;case"TB":t=1024*t*1024*1024*1024*1024;break;case"EB":t=1024*t*1024*1024*1024*1024*1024;break;case"ZB":t=1024*t*1024*1024*1024*1024*1024*1024;break;case"YB":t=1024*t*1024*1024*1024*1024*1024*1024*1024}e.limitSize=t,await s(e)&&l.resetFields()}))},onCancel:()=>{l.resetFields(),o("MB"),a()},confirmLoading:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,w.jsxs)(u.A,{form:l,...k,children:[(0,w.jsx)(u.A.Item,{name:"id",noStyle:!0,children:(0,w.jsx)(f.A,{hidden:!0})}),(0,w.jsx)(u.A.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}],children:(0,w.jsx)(f.A,{autoComplete:"off",placeholder:"\u7f51\u76d8\u7684\u540d\u79f0"})}),(0,w.jsx)(u.A.Item,{label:"\u662f\u5426\u5171\u4eab",name:"isShare",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u5171\u4eab"}],valuePropName:"checked",children:(0,w.jsx)(A.A,{checkedChildren:"\u662f",unCheckedChildren:"\u5426"})}),(0,w.jsx)(u.A.Item,{label:"\u5927\u5c0f\u9650\u5236",name:"limitSize",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5927\u5c0f\u9650\u5236"}],tooltip:"\u65e0\u9650\u5236\u8bf7\u586b\u5199-1",children:(0,w.jsx)(y.A,{min:-1,addonAfter:d,style:{width:275}})})]})})};var I=s(60715),S=s(27891),C=s(68201);const z=m,{Content:F}=a.A,N=i.createRef(),E=()=>{let[e,t]=(0,i.useState)(!1),[s,a]=(0,i.useState)(!1),[d,h]=(0,i.useState)(void 0),[m,u]=(0,i.useState)(!1);const[p,g]=(0,S.j)(S.A.STORAGE),f=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u662f\u5426\u5171\u4eab",dataIndex:"isShare",key:"isShare",hideInSearch:!0,render:e=>e?(0,w.jsx)(n.A,{color:"green",children:"\u662f"}):(0,w.jsx)(n.A,{color:"red",children:"\u5426"})},{title:"\u662f\u5426\u9ed8\u8ba4",dataIndex:"isDefault",key:"isDefault",hideInSearch:!0,render:e=>e?(0,w.jsx)(n.A,{color:"green",children:"\u662f"}):(0,w.jsx)(n.A,{color:"red",children:"\u5426"})},{title:"\u5927\u5c0f\u9650\u5236",dataIndex:"limitSize",key:"limitSize",hideInSearch:!0,render:e=>e<0?"\u65e0\u9650\u5236":(0,x.qI)(e)},{title:"\u5df2\u7528\u5927\u5c0f",dataIndex:"usedSize",key:"usedSize",hideInSearch:!0,render:e=>(0,x.qI)(e)},{title:"\u6240\u5c5e\u7528\u6237",dataIndex:"ownerName",key:"ownerName",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:(e,s,i,a)=>[(0,w.jsx)(C.A,{menu:"storage-browse",children:(0,w.jsx)("a",{onClick:()=>{u(!0),h(s.id)},children:"\u6d4f\u89c8"},"edit")},"storage-browse"),(0,w.jsx)(C.A,{menu:"storage-edit",children:(0,w.jsx)("a",{onClick:()=>{t(!0),h(s.id)},children:"\u7f16\u8f91"},"edit")},"storage-edit"),(0,w.jsx)(C.A,{menu:"storage-del",children:(0,w.jsx)(r.A,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u884c\u5417?",onConfirm:async()=>{await z.deleteById(s.id),N.current.reload()},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,w.jsx)("a",{disabled:s.isDefault,className:"danger",children:"\u5220\u9664"},"delete")},"confirm-delete")},"storage-del")]}];return(0,w.jsx)("div",{children:(0,w.jsxs)(F,{className:"page-container",children:[(0,w.jsx)(o.A,{columns:f,actionRef:N,columnsState:{value:p,onChange:g},request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s="",i="";Object.keys(t).length>0&&(s=Object.keys(t)[0],i=Object.values(t)[0]);let a={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:s,order:i},n=await z.getPaging(a);return{data:n.items,success:!0,total:n.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{pageSize:10},dateFormatter:"string",headerTitle:"\u78c1\u76d8\u7a7a\u95f4\u5217\u8868",toolBarRender:()=>[(0,w.jsx)(C.A,{menu:"storage-add",children:(0,w.jsx)(l.A,{type:"primary",onClick:()=>{t(!0)},children:"\u65b0\u5efa"},"button")})]}),(0,w.jsx)(b,{id:d,visible:e,confirmLoading:s,handleCancel:()=>{t(!1),h(void 0)},handleOk:async e=>{a(!0);try{let s;s=e.id?await z.updateById(e.id,e):await z.create(e),s&&t(!1),N.current.reload()}finally{a(!1)}}}),(0,w.jsx)(c.A,{title:"\u6587\u4ef6\u7ba1\u7406",placement:"right",width:.8*window.innerWidth,closable:!0,maskClosable:!0,onClose:()=>{u(!1),h(void 0),N.current.reload()},visible:m,children:m?(0,w.jsx)(I.A,{storageId:d,storageType:"storages",upload:!0,download:!0,delete:!0,rename:!0,edit:!0,minHeight:window.innerHeight-103}):void 0})]})})}},68201:(e,t,s)=>{s.d(t,{A:()=>a});var i=s(50070);const a=e=>{let{menu:t,children:s}=e;if(Array.isArray(t)){if((0,i.as)(...t))return s}else if((0,i.as)(t))return s}},27891:(e,t,s)=>{s.d(t,{A:()=>r,j:()=>l});var i=s(98409),a=s(9950);let n=new class{constructor(){this.ASSET="cs-asset",this.CREDENTIAL="cs-credential",this.COMMAND="cs-command",this.ACCESS_GATEWAY="cs-access-gateway",this.ONLINE_SESSION="cs-online-session",this.OFFLINE_SESSION="cs-offline-session",this.LOGIN_LOG="cs-login-log",this.STORAGE_LOG="cs-storage-log",this.JOB="cs-job",this.STORAGE="cs-storage",this.LOGIN_POLICY="cs-login-policy",this.ACCESS_SECURITY="cs-access-security",this.USER="cs-user",this.ROLE="cs-role",this.USER_GROUP="cs-user-group",this.COMMAND_FILTER="cs-command-filter",this.STRATEGY="cs-strategy"}};const r=n,l=e=>{let[t,s]=(0,a.useState)(c(e));return[t,t=>{new Promise((e=>{s(t),e(t)})).then((t=>{o(e,t)}))}]},c=e=>{switch(e){case n.ASSET:case n.CREDENTIAL:case n.COMMAND:case n.ACCESS_GATEWAY:case n.ONLINE_SESSION:case n.OFFLINE_SESSION:}return d(e,{})},o=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},d=(e,t)=>{let s=localStorage.getItem(e);if(!i.A.hasText(s))return t;try{return JSON.parse(s)}catch(a){return t}}},98409:(e,t,s)=>{s.d(t,{A:()=>i});const i=new class{constructor(){this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){let s=e.toString();for(;s.length<t;)s="0"+s;return s}}}},9313:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="CloudUploadOutlined";const c=a.forwardRef(l)},94500:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileExcelOutlined";const c=a.forwardRef(l)},2835:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileImageOutlined";const c=a.forwardRef(l)},56149:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM429 481.2c-1.9-4.4-6.2-7.2-11-7.2h-35c-6.6 0-12 5.4-12 12v272c0 6.6 5.4 12 12 12h27.1c6.6 0 12-5.4 12-12V582.1l66.8 150.2a12 12 0 0011 7.1H524c4.7 0 9-2.8 11-7.1l66.8-150.6V758c0 6.6 5.4 12 12 12H641c6.6 0 12-5.4 12-12V486c0-6.6-5.4-12-12-12h-34.7c-4.8 0-9.1 2.8-11 7.2l-83.1 191-83.2-191z"}}]},name:"file-markdown",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileMarkdownOutlined";const c=a.forwardRef(l)},42025:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M531.3 574.4l.3-1.4c5.8-23.9 13.1-53.7 7.4-80.7-3.8-21.3-19.5-29.6-32.9-30.2-15.8-.7-29.9 8.3-33.4 21.4-6.6 24-.7 56.8 10.1 98.6-13.6 32.4-35.3 79.5-51.2 107.5-29.6 15.3-69.3 38.9-75.2 68.7-1.2 5.5.2 12.5 3.5 18.8 3.7 7 9.6 12.4 16.5 15 3 1.1 6.6 2 10.8 2 17.6 0 46.1-14.2 84.1-79.4 5.8-1.9 11.8-3.9 17.6-5.9 27.2-9.2 55.4-18.8 80.9-23.1 28.2 15.1 60.3 24.8 82.1 24.8 21.6 0 30.1-12.8 33.3-20.5 5.6-13.5 2.9-30.5-6.2-39.6-13.2-13-45.3-16.4-95.3-10.2-24.6-15-40.7-35.4-52.4-65.8zM421.6 726.3c-13.9 20.2-24.4 30.3-30.1 34.7 6.7-12.3 19.8-25.3 30.1-34.7zm87.6-235.5c5.2 8.9 4.5 35.8.5 49.4-4.9-19.9-5.6-48.1-2.7-51.4.8.1 1.5.7 2.2 2zm-1.6 120.5c10.7 18.5 24.2 34.4 39.1 46.2-21.6 4.9-41.3 13-58.9 20.2-4.2 1.7-8.3 3.4-12.3 5 13.3-24.1 24.4-51.4 32.1-71.4zm155.6 65.5c.1.2.2.5-.4.9h-.2l-.2.3c-.8.5-9 5.3-44.3-8.6 40.6-1.9 45 7.3 45.1 7.4zm191.4-388.2L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-pdf",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FilePdfOutlined";const c=a.forwardRef(l)},47738:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileTextOutlined";const c=a.forwardRef(l)},39742:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM528.1 472h-32.2c-5.5 0-10.3 3.7-11.6 9.1L434.6 680l-46.1-198.7c-1.3-5.4-6.1-9.3-11.7-9.3h-35.4a12.02 12.02 0 00-11.6 15.1l74.2 276c1.4 5.2 6.2 8.9 11.6 8.9h32c5.4 0 10.2-3.6 11.6-8.9l52.8-197 52.8 197c1.4 5.2 6.2 8.9 11.6 8.9h31.8c5.4 0 10.2-3.6 11.6-8.9l74.4-276a12.04 12.04 0 00-11.6-15.1H647c-5.6 0-10.4 3.9-11.7 9.3l-45.8 199.1-49.8-199.3c-1.3-5.4-6.1-9.1-11.6-9.1z"}}]},name:"file-word",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileWordOutlined";const c=a.forwardRef(l)},46995:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 392h64v64h-64zm0 190v160h128V582h-64v-62h-64v62zm80 48v64h-32v-64h32zm-16-302h64v64h-64zm-64-64h64v64h-64zm64 192h64v64h-64zm0-256h64v64h-64zm494.6 88.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h64v64h64v-64h174v216a42 42 0 0042 42h216v494z"}}]},name:"file-zip",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FileZipOutlined";const c=a.forwardRef(l)},87621:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FolderAddOutlined";const c=a.forwardRef(l)},31023:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:function(e,t){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z",fill:e}},{tag:"path",attrs:{d:"M372.5 256H184v512h656V370.4H492.1z",fill:t}}]}},name:"folder",theme:"twotone"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="FolderTwoTone";const c=a.forwardRef(l)},51598:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(89379),a=s(9950);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};var r=s(38913),l=function(e,t){return a.createElement(r.A,(0,i.A)((0,i.A)({},e),{},{ref:t,icon:n}))};l.displayName="UploadOutlined";const c=a.forwardRef(l)}}]);