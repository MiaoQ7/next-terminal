"use strict";(self.webpackChunknext_terminal=self.webpackChunknext_terminal||[]).push([[8658],{16018:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(93766),r=s(21215),n=s.n(r);class i{constructor(e){this.group="",this.getById=async e=>{let t=await a.A.get("/".concat(this.group,"/").concat(e));if(1===t.code)return t.data},this.getPaging=async e=>{let t=n().stringify(e),s=await a.A.get("/".concat(this.group,"/paging?").concat(t));return 1!==s.code?{}:s.data},this.getAll=async()=>{let e=await a.A.get("/".concat(this.group));return 1!==e.code?[]:e.data},this.create=async e=>1===(await a.A.post("/".concat(this.group),e)).code,this.updateById=async(e,t)=>1===(await a.A.put("/".concat(this.group,"/").concat(e),t)).code,this.deleteById=async e=>1===(await a.A.delete("/".concat(this.group,"/").concat(e))).code,this.group=e}}},38658:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(9950),r=s(68832),n=s(12916),i=s(52735),c=s(74947),l=s(56231),d=s(48538),o=s(16018);class h extends o.A{constructor(){super("access-gateways")}}const u=new h;var p=s(27666),g=s(55902),A=s(87827),x=s(87427),m=s(99674),y=s(6579),j=s(44414);const S={labelCol:{span:6},wrapperCol:{span:14}},{TextArea:I}=g.A,w=u,O=e=>{let{visible:t,handleOk:s,handleCancel:r,confirmLoading:n,id:i}=e;const[c]=A.A.useForm();let[l,d]=(0,a.useState)("ssh"),[o,h]=(0,a.useState)("password");return(0,a.useEffect)((()=>{t?i?(async()=>{let e=await w.getById(i);e&&(c.setFieldsValue(e),d(e.gatewayType),h(e.accountType))})():(c.setFieldsValue({gatewayType:"ssh",accountType:"password",port:22}),d("ssh"),h("password")):c.resetFields()}),[t]),(0,j.jsx)(x.A,{title:i?"\u66f4\u65b0\u63a5\u5165\u7f51\u5173":"\u65b0\u5efa\u63a5\u5165\u7f51\u5173",visible:t,maskClosable:!1,destroyOnClose:!0,onOk:()=>{c.validateFields().then((async e=>{await s(e)&&c.resetFields()}))},onCancel:()=>{c.resetFields(),r()},confirmLoading:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,j.jsxs)(A.A,{form:c,...S,children:[(0,j.jsx)(A.A.Item,{name:"id",noStyle:!0,children:(0,j.jsx)(g.A,{hidden:!0})}),(0,j.jsx)(A.A.Item,{label:"\u7f51\u5173\u7c7b\u578b",name:"gatewayType",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u7f51\u5173\u7c7b\u578b"}],children:(0,j.jsxs)(m.A,{onChange:e=>{d(e),c.setFieldValue("port","ssh"===e?22:443)},children:[(0,j.jsx)(m.A.Option,{value:"ssh",children:"SSH"},"ssh"),(0,j.jsx)(m.A.Option,{value:"rdp",children:"RDP"},"rdp")]})}),(0,j.jsx)(A.A.Item,{label:"\u7f51\u5173\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7f51\u5173\u540d\u79f0"}],children:(0,j.jsx)(g.A,{placeholder:"\u7f51\u5173\u540d\u79f0"})}),(0,j.jsx)(A.A.Item,{label:"\u4e3b\u673a",name:"ip",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7f51\u5173\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"}],children:(0,j.jsx)(g.A,{placeholder:"\u7f51\u5173\u7684\u4e3b\u673a\u540d\u79f0\u6216\u8005IP\u5730\u5740"})}),(0,j.jsx)(A.A.Item,{label:"\u7aef\u53e3\u53f7",name:"port",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3"}],children:(0,j.jsx)(y.A,{min:1,max:65535,placeholder:"TCP\u7aef\u53e3"})}),"ssh"===l&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(A.A.Item,{label:"\u8d26\u6237\u7c7b\u578b",name:"accountType",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d26\u6237\u7c7b\u578b"}],children:(0,j.jsxs)(m.A,{onChange:e=>{h(e)},children:[(0,j.jsx)(m.A.Option,{value:"password",children:"\u5bc6\u7801"},"password"),(0,j.jsx)(m.A.Option,{value:"private-key",children:"\u5bc6\u94a5"},"private-key")]})}),"password"===o?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("input",{type:"password",hidden:!0,autoComplete:"new-password"}),(0,j.jsx)(A.A.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",rules:[{required:!0}],children:(0,j.jsx)(g.A,{placeholder:"root"})}),(0,j.jsx)(A.A.Item,{label:"\u6388\u6743\u5bc6\u7801",name:"password",rules:[{required:!0}],children:(0,j.jsx)(g.A.Password,{placeholder:"password"})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(A.A.Item,{label:"\u6388\u6743\u8d26\u6237",name:"username",rules:[{required:!0}],children:(0,j.jsx)(g.A,{placeholder:"\u8f93\u5165\u6388\u6743\u8d26\u6237"})}),(0,j.jsx)(A.A.Item,{label:"\u79c1\u94a5",name:"privateKey",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u79c1\u94a5"}],children:(0,j.jsx)(I,{rows:4})}),(0,j.jsx)(A.A.Item,{label:"\u79c1\u94a5\u5bc6\u7801",name:"passphrase",children:(0,j.jsx)(I,{rows:1})})]})]})]})})};var T=s(27891),C=s(68201);const{Content:f}=r.A,E=u,v=a.createRef(),k=()=>{let[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(!1),[o,h]=(0,a.useState)(void 0);const[u,g]=(0,T.j)(T.A.ACCESS_GATEWAY),A=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u7f51\u5173\u7c7b\u578b",dataIndex:"gatewayType",key:"gatewayType",hideInSearch:!0},{title:"\u540d\u79f0",dataIndex:"name"},{title:"IP",dataIndex:"ip",key:"ip",sorter:!0,hideInSearch:!0},{title:"\u7aef\u53e3",dataIndex:"port",key:"port",hideInSearch:!0},{title:"\u8d26\u6237\u7c7b\u578b",dataIndex:"accountType",key:"accountType",hideInSearch:!0,render:e=>"private-key"===e?(0,j.jsx)(n.A,{color:"green",children:"\u5bc6\u94a5"}):"password"===e?(0,j.jsx)(n.A,{color:"red",children:"\u5bc6\u7801"}):(0,j.jsx)(j.Fragment,{children:"-"})},{title:"\u6388\u6743\u8d26\u6237",dataIndex:"username",key:"username",hideInSearch:!0},{title:"\u72b6\u6001",dataIndex:"connected",key:"connected",hideInSearch:!0,render:(e,t)=>e?(0,j.jsx)(i.A,{title:"\u8fde\u63a5\u6210\u529f",children:(0,j.jsx)(c.A,{status:"success",text:"\u5df2\u8fde\u63a5"})}):(0,j.jsx)(i.A,{title:t.message,children:(0,j.jsx)(c.A,{status:"default",text:"\u5df2\u65ad\u5f00"})})},{title:"\u521b\u5efa\u65f6\u95f4",key:"created",dataIndex:"created",hideInSearch:!0},{title:"\u64cd\u4f5c",valueType:"option",key:"option",render:(e,s,a,r)=>[(0,j.jsx)(C.A,{menu:"access-gateway-edit",children:(0,j.jsx)("a",{onClick:()=>{t(!0),h(s.id)},children:"\u7f16\u8f91"},"edit")},"access-gateway-edit"),(0,j.jsx)(C.A,{menu:"access-gateway-del",children:(0,j.jsx)(l.A,{title:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u6b64\u884c\u5417?",onConfirm:async()=>{await E.deleteById(s.id),v.current.reload()},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,j.jsx)("a",{className:"danger",children:"\u5220\u9664"},"delete")},"confirm-delete")},"access-gateway-del")]}];return(0,j.jsxs)(f,{className:"page-container",children:[(0,j.jsx)(p.A,{columns:A,actionRef:v,columnsState:{value:u,onChange:g},request:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s="",a="";Object.keys(t).length>0&&(s=Object.keys(t)[0],a=Object.values(t)[0]);let r={pageIndex:e.current,pageSize:e.pageSize,name:e.name,field:s,order:a},n=await E.getPaging(r);return{data:n.items,success:!0,total:n.total}},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:"\u63a5\u5165\u7f51\u5173\u5217\u8868",toolBarRender:()=>[(0,j.jsx)(C.A,{menu:"access-gateway-add",children:(0,j.jsx)(d.A,{type:"primary",onClick:()=>{t(!0)},children:"\u65b0\u5efa"},"button")})]}),(0,j.jsx)(O,{id:o,visible:e,confirmLoading:s,handleCancel:()=>{t(!1),h(void 0)},handleOk:async e=>{r(!0);try{let s;s=e.id?await E.updateById(e.id,e):await E.create(e),s&&t(!1),v.current.reload()}finally{r(!1)}}})]})}},68201:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(50070);const r=e=>{let{menu:t,children:s}=e;if(Array.isArray(t)){if((0,a.as)(...t))return s}else if((0,a.as)(t))return s}},27891:(e,t,s)=>{s.d(t,{A:()=>i,j:()=>c});var a=s(98409),r=s(9950);let n=new class{constructor(){this.ASSET="cs-asset",this.CREDENTIAL="cs-credential",this.COMMAND="cs-command",this.ACCESS_GATEWAY="cs-access-gateway",this.ONLINE_SESSION="cs-online-session",this.OFFLINE_SESSION="cs-offline-session",this.LOGIN_LOG="cs-login-log",this.STORAGE_LOG="cs-storage-log",this.JOB="cs-job",this.STORAGE="cs-storage",this.LOGIN_POLICY="cs-login-policy",this.ACCESS_SECURITY="cs-access-security",this.USER="cs-user",this.ROLE="cs-role",this.USER_GROUP="cs-user-group",this.COMMAND_FILTER="cs-command-filter",this.STRATEGY="cs-strategy"}};const i=n,c=e=>{let[t,s]=(0,r.useState)(l(e));return[t,t=>{new Promise((e=>{s(t),e(t)})).then((t=>{d(e,t)}))}]},l=e=>{switch(e){case n.ASSET:case n.CREDENTIAL:case n.COMMAND:case n.ACCESS_GATEWAY:case n.ONLINE_SESSION:case n.OFFLINE_SESSION:}return o(e,{})},d=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},o=(e,t)=>{let s=localStorage.getItem(e);if(!a.A.hasText(s))return t;try{return JSON.parse(s)}catch(r){return t}}},98409:(e,t,s)=>{s.d(t,{A:()=>a});const a=new class{constructor(){this.hasText=function(e){return!(void 0===e||null===e||0===e.length)},this.zeroPad=function(e,t){let s=e.toString();for(;s.length<t;)s="0"+s;return s}}}}}]);